//#####################################################################
// Copyright 2003-2011, Ron Fedkiw, Geoffrey Irving, Igor Neverov, Eftychios Sifakis, Russell Howes, Joseph Teran.
// This file is part of PhysBAM whose distribution is governed by the license contained in the accompanying file PHYSBAM_COPYRIGHT.txt.
//#####################################################################
#include <PhysBAM_Tools/Math_Tools/cube.h>
#include <PhysBAM_Tools/Math_Tools/pow.h>
#include <PhysBAM_Tools/Matrices/DIAGONAL_MATRIX_2X2.h>
#include <PhysBAM_Tools/Matrices/DIAGONAL_MATRIX_3X3.h>
#include <PhysBAM_Tools/Matrices/MATRIX_2X2.h>
#include <PhysBAM_Tools/Matrices/MATRIX_3X3.h>
#include <PhysBAM_Tools/Matrices/SYMMETRIC_MATRIX_2X2.h>
#include <PhysBAM_Tools/Matrices/SYMMETRIC_MATRIX_3X3.h>
#include <PhysBAM_Solids/PhysBAM_Deformables/Constitutive_Models/DIAGONALIZED_ISOTROPIC_STRESS_DERIVATIVE.h>
#include <PhysBAM_Solids/PhysBAM_Deformables/Constitutive_Models/MOONEY_RIVLIN_3D_EXTRAPOLATED.h>
using namespace PhysBAM;
//#####################################################################
// Constructor
//#####################################################################
template<class T,int d> MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
MOONEY_RIVLIN_3D_EXTRAPOLATED(const T youngs_modulus_input,const T poissons_ratio_input,const T Rayleigh_coefficient,const T extrapolation_cutoff_input, const T extra_force_coefficient_input):
    youngs_modulus(youngs_modulus_input),poissons_ratio(poissons_ratio_input),
    extrapolation_cutoff(extrapolation_cutoff_input),extra_force_coefficient(extra_force_coefficient_input),
    panic_threshold((T)1e-6)
{
    assert(poissons_ratio>-1&&poissons_ratio<.5);
    constant_lambda=youngs_modulus*poissons_ratio/((1+poissons_ratio)*(1-2*poissons_ratio));
    constant_mu=youngs_modulus/(2*(1+poissons_ratio));
    mu_10=(T)3*constant_mu/(T)8;    //Keep the 3 to 1 ratio of mu_10 to mu_01 that was found in the other model's default parameters
    mu_01=constant_mu/(T)8;
    kappa=constant_lambda-(T)2*constant_mu/(T)3;
    constant_alpha=Rayleigh_coefficient*constant_lambda;
    constant_beta=Rayleigh_coefficient*constant_mu;
    //base.Initialize(constant_mu,constant_lambda);
}
//#####################################################################
// Destructor
//#####################################################################
template<class T,int d> MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
~MOONEY_RIVLIN_3D_EXTRAPOLATED()
{
}
//#####################################################################
// Update Lame Constants
//#####################################################################
template<class T,int d> void MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
Update_Lame_Constants(const T youngs_modulus_input, const T poissons_ratio_input,const T Rayleigh_coefficient_input)
{
    constant_lambda=youngs_modulus_input*poissons_ratio_input/((1+poissons_ratio_input)*(1-2*poissons_ratio_input));
    constant_mu=youngs_modulus_input/(2*(1+poissons_ratio_input));
    constant_alpha=Rayleigh_coefficient_input*constant_lambda;
    constant_beta=Rayleigh_coefficient_input*constant_mu;
    youngs_modulus=youngs_modulus_input; poissons_ratio=poissons_ratio_input;
    
}
//#####################################################################
// Function Energy_Density
//#####################################################################
template<class T,int d> T MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
Energy_Density(const DIAGONAL_MATRIX<T,d>& F,const int simplex) const
{
    return Energy_Density_Helper(F,simplex);
}
//#####################################################################
// Function Energy_Density_Helper
//#####################################################################
template<class T,int d> T MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
Energy_Density_Helper(const DIAGONAL_MATRIX<T,2>& F,const int simplex) const
{
    PHYSBAM_FATAL_ERROR();
    return 0;
}
//#####################################################################
// Function Energy_Density_Helper
//#####################################################################
template<class T,int d> T MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
Energy_Density_Helper(const DIAGONAL_MATRIX<T,3>& F,const int simplex) const
{
    
    T s1 = F.x11;
    T s2 = F.x22;
    T s3 = F.x33;
    
//    T mu = constant_mu;
 //   T la = constant_lambda;   
    
    T a = extrapolation_cutoff;
    T k = extra_force_coefficient*youngs_modulus;

    T dx = s1 - a;
    T dy = s2 - a;
    T dz = s3 - a;
    
    T kap = kappa;
    T m10 = mu_10; T m01=mu_01;

    if ((dx >= 0) && (dy >= 0) && (dz >= 0)) // R
    {
        return kap*pow(log(s1*s2*s3),2.0)*(1.0/2.0)+(m01*(s2*s2)*(s3*s3)+1.0/(s2*s2)*1.0/(s3*s3)*(m10*(s2*s2)*(s3*s3*s3*s3)*2.0+m10*(s2*s2*s2*s2)*(s3*s3)*2.0)*pow(s1*s2*s3,2.0/3.0)*(1.0/2.0))*1.0/pow(s1*s2*s3,4.0/3.0)+1.0/(s2*s2*s2*s2)*1.0/(s3*s3*s3*s3)*pow(s1*s2*s3,2.0/3.0)*(m01*(s2*s2)*(s3*s3*s3*s3)*4.0+m01*(s2*s2*s2*s2)*(s3*s3)*4.0+m01*(s1*s1)*(s2*s2)*(s3*s3)+m10*(s2*s2)*(s3*s3)*pow(s1*s2*s3,2.0/3.0)*2.0)*(3.0/4.0)-m01*1.0/(s2*s2*s2*s2)*1.0/(s3*s3*s3*s3)*pow(s1*s2*s3,8.0/3.0)*(3.0/4.0)-m10*1.0/(s2*s2)*1.0/(s3*s3)*pow(s1*s2*s3,4.0/3.0)*(1.0/2.0)-1.0/(s2*s2)*1.0/(s3*s3)*(m01*(s2*s2)*4.0+m01*(s3*s3)*4.0)*pow(s1*s2*s3,2.0/3.0)*(1.0/2.0);

    }
    else if ((dx < 0) && (dy >= 0) && (dz >= 0)) // Rx
    {
        return kap*pow(log(a*s2*s3),2.0)*(1.0/2.0)+(m01*(s2*s2)*(s3*s3)+1.0/(s2*s2)*1.0/(s3*s3)*(m10*(s2*s2)*(s3*s3*s3*s3)*2.0+m10*(s2*s2*s2*s2)*(s3*s3)*2.0)*pow(a*s2*s3,2.0/3.0)*(1.0/2.0))*1.0/pow(a*s2*s3,4.0/3.0)+k*pow(a-s1,2.0)-(a-s1)*((kap*log(a*s2*s3))/a+((m10*(s2*s2)*(s3*s3*s3*s3)*2.0+m10*(s2*s2*s2*s2)*(s3*s3)*2.0)*1.0/pow(a*s2*s3,5.0/3.0)*(1.0/3.0))/(s2*s3)-s2*s3*(m01*(s2*s2)*(s3*s3)+1.0/(s2*s2)*1.0/(s3*s3)*(m10*(s2*s2)*(s3*s3*s3*s3)*2.0+m10*(s2*s2*s2*s2)*(s3*s3)*2.0)*pow(a*s2*s3,2.0/3.0)*(1.0/2.0))*1.0/pow(a*s2*s3,7.0/3.0)*(4.0/3.0)-m01*1.0/(s2*s2*s2)*1.0/(s3*s3*s3)*pow(a*s2*s3,5.0/3.0)*2.0-(m10*pow(a*s2*s3,1.0/3.0)*(2.0/3.0))/(s2*s3)-((m01*(s2*s2)*4.0+m01*(s3*s3)*4.0)*1.0/pow(a*s2*s3,1.0/3.0)*(1.0/3.0))/(s2*s3)+1.0/(s2*s2*s2*s2)*1.0/(s3*s3*s3*s3)*(m10*(s2*s2*s2)*(s3*s3*s3)*1.0/pow(a*s2*s3,1.0/3.0)*(4.0/3.0)+a*m01*(s2*s2)*(s3*s3)*2.0)*pow(a*s2*s3,2.0/3.0)*(3.0/4.0)+1.0/(s2*s2*s2)*1.0/(s3*s3*s3)*1.0/pow(a*s2*s3,1.0/3.0)*(m01*(s2*s2)*(s3*s3*s3*s3)*4.0+m01*(s2*s2*s2*s2)*(s3*s3)*4.0+(a*a)*m01*(s2*s2)*(s3*s3)+m10*(s2*s2)*(s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0)*(1.0/2.0))-m01*1.0/(s2*s2*s2*s2)*1.0/(s3*s3*s3*s3)*pow(a*s2*s3,8.0/3.0)*(3.0/4.0)-m10*1.0/(s2*s2)*1.0/(s3*s3)*pow(a*s2*s3,4.0/3.0)*(1.0/2.0)-1.0/(s2*s2)*1.0/(s3*s3)*(m01*(s2*s2)*4.0+m01*(s3*s3)*4.0)*pow(a*s2*s3,2.0/3.0)*(1.0/2.0)+1.0/(s2*s2*s2*s2)*1.0/(s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*(m01*(s2*s2)*(s3*s3*s3*s3)*4.0+m01*(s2*s2*s2*s2)*(s3*s3)*4.0+(a*a)*m01*(s2*s2)*(s3*s3)+m10*(s2*s2)*(s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0)*(3.0/4.0);
    }
    else if ((dx >= 0) && (dy < 0) && (dz >= 0)) // Ry
    {
        return  kap*pow(log(a*s1*s3),2.0)*(1.0/2.0)+(a*a)*k+k*(s2*s2)-kap*log(a*s1*s3)-a*k*s2*2.0+(kap*s2*log(a*s1*s3))/a+a*m10*s1*(s3*s3*s3)*1.0/pow(a*s1*s3,5.0/3.0)*(5.0/3.0)+a*m10*(s1*s1*s1)*s3*1.0/pow(a*s1*s3,5.0/3.0)*(5.0/3.0)-(a*a*a)*m10*s1*s3*1.0/pow(a*s1*s3,5.0/3.0)*(1.0/3.0)-m10*s1*s2*(s3*s3*s3)*1.0/pow(a*s1*s3,5.0/3.0)*(2.0/3.0)-m10*(s1*s1*s1)*s2*s3*1.0/pow(a*s1*s3,5.0/3.0)*(2.0/3.0)+a*m01*(s1*s1*s1)*(s3*s3*s3)*1.0/pow(a*s1*s3,7.0/3.0)*(7.0/3.0)+(a*a*a)*m01*s1*(s3*s3*s3)*1.0/pow(a*s1*s3,7.0/3.0)*(1.0/3.0)+(a*a*a)*m01*(s1*s1*s1)*s3*1.0/pow(a*s1*s3,7.0/3.0)*(1.0/3.0)-m01*(s1*s1*s1)*s2*(s3*s3*s3)*1.0/pow(a*s1*s3,7.0/3.0)*(4.0/3.0)+(a*a)*m01*s1*s2*(s3*s3*s3)*1.0/pow(a*s1*s3,7.0/3.0)*(2.0/3.0)+(a*a)*m01*(s1*s1*s1)*s2*s3*1.0/pow(a*s1*s3,7.0/3.0)*(2.0/3.0)+(a*a)*m10*s1*s2*s3*1.0/pow(a*s1*s3,5.0/3.0)*(4.0/3.0);
    }
    else if ((dx >= 0) && (dy >= 0) && (dz < 0)) // Rz
    {
        return kap*pow(log(a*s1*s2),2.0)*(1.0/2.0)+(a*a)*k+k*(s3*s3)-kap*log(a*s1*s2)-a*k*s3*2.0+(kap*s3*log(a*s1*s2))/a+a*m10*s1*(s2*s2*s2)*1.0/pow(a*s1*s2,5.0/3.0)*(5.0/3.0)+a*m10*(s1*s1*s1)*s2*1.0/pow(a*s1*s2,5.0/3.0)*(5.0/3.0)-(a*a*a)*m10*s1*s2*1.0/pow(a*s1*s2,5.0/3.0)*(1.0/3.0)-m10*s1*(s2*s2*s2)*s3*1.0/pow(a*s1*s2,5.0/3.0)*(2.0/3.0)-m10*(s1*s1*s1)*s2*s3*1.0/pow(a*s1*s2,5.0/3.0)*(2.0/3.0)+a*m01*(s1*s1*s1)*(s2*s2*s2)*1.0/pow(a*s1*s2,7.0/3.0)*(7.0/3.0)+(a*a*a)*m01*s1*(s2*s2*s2)*1.0/pow(a*s1*s2,7.0/3.0)*(1.0/3.0)+(a*a*a)*m01*(s1*s1*s1)*s2*1.0/pow(a*s1*s2,7.0/3.0)*(1.0/3.0)-m01*(s1*s1*s1)*(s2*s2*s2)*s3*1.0/pow(a*s1*s2,7.0/3.0)*(4.0/3.0)+(a*a)*m01*s1*(s2*s2*s2)*s3*1.0/pow(a*s1*s2,7.0/3.0)*(2.0/3.0)+(a*a)*m01*(s1*s1*s1)*s2*s3*1.0/pow(a*s1*s2,7.0/3.0)*(2.0/3.0)+(a*a)*m10*s1*s2*s3*1.0/pow(a*s1*s2,5.0/3.0)*(4.0/3.0);
    }
    else if ((dx < 0) && (dy < 0) && (dz >= 0)) // Rxy
    {
        return kap+kap*pow(log((a*a)*s3),2.0)*(1.0/2.0)+(a*a)*k*2.0+k*(s1*s1)+k*(s2*s2)-kap*log((a*a)*s3)*2.0-(m10*pow((a*a)*s3,1.0/3.0)*(1.0E1/9.0))/s3+m10*(s3*s3)*1.0/pow((a*a)*s3,2.0/3.0)*(2.5E1/9.0)-a*k*s1*2.0-a*k*s2*2.0-(kap*s1)/a-(kap*s2)/a+pow(a,1.0E1)*m01*(s3*s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.6E1/3.0)*(1.4E1/9.0)+pow(a,1.2E1)*m01*(s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.6E1/3.0)*(1.0/9.0)+1.0/(a*a)*kap*s1*s2-m10*s1*s2*1.0/pow((a*a)*s3,2.0/3.0)*(1.6E1/9.0)+(kap*s1*log((a*a)*s3))/a+(kap*s2*log((a*a)*s3))/a+m10*s1*s2*(s3*s3*s3)*1.0/pow((a*a)*s3,5.0/3.0)*(4.0/9.0)+(a*a*a*a*a*a*a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.6E1/3.0)*(1.0E1/9.0)+pow(a,1.1E1)*m01*s1*(s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.6E1/3.0)*(2.0/9.0)+(m10*s1*pow((a*a)*s3,1.0/3.0)*(2.2E1/9.0))/(a*s3)-(m10*s1*(s3*s3)*1.0/pow((a*a)*s3,2.0/3.0)*(1.0E1/9.0))/a+(a*a*a*a*a*a*a*a*a)*m01*s2*(s3*s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.6E1/3.0)*(1.0E1/9.0)+pow(a,1.1E1)*m01*s2*(s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.6E1/3.0)*(2.0/9.0)+(m10*s2*pow((a*a)*s3,1.0/3.0)*(2.2E1/9.0))/(a*s3)-(m10*s2*(s3*s3)*1.0/pow((a*a)*s3,2.0/3.0)*(1.0E1/9.0))/a-(a*a*a*a*a*a*a*a)*m01*s1*s2*(s3*s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.6E1/3.0)*(1.6E1/9.0)+pow(a,1.0E1)*m01*s1*s2*(s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.6E1/3.0)*(4.0/9.0);

    }
    else if ((dx < 0) && (dy >= 0) && (dz < 0)) // Rzx
    {
        return kap+kap*pow(log((a*a)*s2),2.0)*(1.0/2.0)+(a*a)*k*2.0+k*(s1*s1)+k*(s3*s3)-kap*log((a*a)*s2)*2.0-(m10*pow((a*a)*s2,1.0/3.0)*(1.0E1/9.0))/s2+m10*(s2*s2)*1.0/pow((a*a)*s2,2.0/3.0)*(2.5E1/9.0)-a*k*s1*2.0-a*k*s3*2.0-(kap*s1)/a-(kap*s3)/a+pow(a,1.0E1)*m01*(s2*s2*s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.6E1/3.0)*(1.4E1/9.0)+pow(a,1.2E1)*m01*(s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.6E1/3.0)*(1.0/9.0)+1.0/(a*a)*kap*s1*s3-m10*s1*s3*1.0/pow((a*a)*s2,2.0/3.0)*(1.6E1/9.0)+(kap*s1*log((a*a)*s2))/a+(kap*s3*log((a*a)*s2))/a+m10*s1*(s2*s2*s2)*s3*1.0/pow((a*a)*s2,5.0/3.0)*(4.0/9.0)+(a*a*a*a*a*a*a*a*a)*m01*s1*(s2*s2*s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.6E1/3.0)*(1.0E1/9.0)+pow(a,1.1E1)*m01*s1*(s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.6E1/3.0)*(2.0/9.0)+(m10*s1*pow((a*a)*s2,1.0/3.0)*(2.2E1/9.0))/(a*s2)-(m10*s1*(s2*s2)*1.0/pow((a*a)*s2,2.0/3.0)*(1.0E1/9.0))/a+(a*a*a*a*a*a*a*a*a)*m01*(s2*s2*s2*s2*s2*s2)*s3*1.0/pow((a*a)*s2,1.6E1/3.0)*(1.0E1/9.0)+pow(a,1.1E1)*m01*(s2*s2*s2*s2)*s3*1.0/pow((a*a)*s2,1.6E1/3.0)*(2.0/9.0)+(m10*s3*pow((a*a)*s2,1.0/3.0)*(2.2E1/9.0))/(a*s2)-(m10*(s2*s2)*s3*1.0/pow((a*a)*s2,2.0/3.0)*(1.0E1/9.0))/a-(a*a*a*a*a*a*a*a)*m01*s1*(s2*s2*s2*s2*s2*s2)*s3*1.0/pow((a*a)*s2,1.6E1/3.0)*(1.6E1/9.0)+pow(a,1.0E1)*m01*s1*(s2*s2*s2*s2)*s3*1.0/pow((a*a)*s2,1.6E1/3.0)*(4.0/9.0);

    }
    else if ((dx >= 0) && (dy < 0) && (dz < 0)) // Ryz
    {
        return kap+kap*pow(log((a*a)*s1),2.0)*(1.0/2.0)+(a*a)*k*2.0+k*(s2*s2)+k*(s3*s3)-kap*log((a*a)*s1)*2.0-a*k*s2*2.0-a*k*s3*2.0-(kap*s2)/a-(kap*s3)/a+pow(a,1.6E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*1.0/pow((a*a)*s1,2.5E1/3.0)*(1.4E1/9.0)+pow(a,1.8E1)*m01*(s1*s1*s1*s1*s1*s1*s1)*1.0/pow((a*a)*s1,2.5E1/3.0)*(1.0/9.0)+(a*a*a*a*a*a)*m10*(s1*s1*s1*s1*s1)*1.0/pow((a*a)*s1,1.1E1/3.0)*(2.5E1/9.0)-pow(a,1.2E1)*m10*(s1*s1*s1*s1*s1)*1.0/pow((a*a)*s1,1.7E1/3.0)*(1.0E1/9.0)+1.0/(a*a)*kap*s2*s3+(kap*s2*log((a*a)*s1))/a+(kap*s3*log((a*a)*s1))/a+pow(a,1.5E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s2*1.0/pow((a*a)*s1,2.5E1/3.0)*(1.0E1/9.0)+pow(a,1.7E1)*m01*(s1*s1*s1*s1*s1*s1*s1)*s2*1.0/pow((a*a)*s1,2.5E1/3.0)*(2.0/9.0)-(a*a*a*a*a)*m10*(s1*s1*s1*s1*s1)*s2*1.0/pow((a*a)*s1,1.1E1/3.0)*(1.0E1/9.0)+pow(a,1.1E1)*m10*(s1*s1*s1*s1*s1)*s2*1.0/pow((a*a)*s1,1.7E1/3.0)*(2.2E1/9.0)+pow(a,1.5E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s3*1.0/pow((a*a)*s1,2.5E1/3.0)*(1.0E1/9.0)+pow(a,1.7E1)*m01*(s1*s1*s1*s1*s1*s1*s1)*s3*1.0/pow((a*a)*s1,2.5E1/3.0)*(2.0/9.0)-(a*a*a*a*a)*m10*(s1*s1*s1*s1*s1)*s3*1.0/pow((a*a)*s1,1.1E1/3.0)*(1.0E1/9.0)+pow(a,1.1E1)*m10*(s1*s1*s1*s1*s1)*s3*1.0/pow((a*a)*s1,1.7E1/3.0)*(2.2E1/9.0)-pow(a,1.4E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s2*s3*1.0/pow((a*a)*s1,2.5E1/3.0)*(1.6E1/9.0)+pow(a,1.6E1)*m01*(s1*s1*s1*s1*s1*s1*s1)*s2*s3*1.0/pow((a*a)*s1,2.5E1/3.0)*(4.0/9.0)+(a*a*a*a)*m10*(s1*s1*s1*s1*s1)*s2*s3*1.0/pow((a*a)*s1,1.1E1/3.0)*(4.0/9.0)-pow(a,1.0E1)*m10*(s1*s1*s1*s1*s1)*s2*s3*1.0/pow((a*a)*s1,1.7E1/3.0)*(1.6E1/9.0);

    }
    else // Rxyz
    {
        return kap*3.0+kap*pow(log(a*a*a),2.0)*(1.0/2.0)+(a*a)*k*3.0+k*(s1*s1)+k*(s2*s2)+k*(s3*s3)-kap*log(a*a*a)*3.0+a*m01*1.0/pow(a*a*a,1.0/3.0)*(7.0/9.0)+m01*s1*1.0/pow(a*a*a,1.0/3.0)*(8.0/9.0)+m01*s2*1.0/pow(a*a*a,1.0/3.0)*(8.0/9.0)+m01*s3*1.0/pow(a*a*a,1.0/3.0)*(8.0/9.0)-a*k*s1*2.0-a*k*s2*2.0-a*k*s3*2.0-(m10*pow(a*a*a,1.0/3.0)*(2.5E1/9.0))/a-(kap*s1*2.0)/a-(kap*s2*2.0)/a-(kap*s3*2.0)/a+1.0/(a*a)*m10*s1*pow(a*a*a,1.0/3.0)*(4.0E1/9.0)+1.0/(a*a)*m10*s2*pow(a*a*a,1.0/3.0)*(4.0E1/9.0)+1.0/(a*a)*m10*s3*pow(a*a*a,1.0/3.0)*(4.0E1/9.0)+(kap*s1*log(a*a*a))/a+(kap*s2*log(a*a*a))/a+(kap*s3*log(a*a*a))/a+1.0/(a*a)*kap*s1*s2+1.0/(a*a)*kap*s1*s3+1.0/(a*a)*kap*s2*s3+(m01*s1*s2*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0))/a-1.0/(a*a*a)*m10*s1*s2*pow(a*a*a,1.0/3.0)*(2.8E1/9.0)+(m01*s1*s3*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0))/a-1.0/(a*a*a)*m10*s1*s3*pow(a*a*a,1.0/3.0)*(2.8E1/9.0)+(m01*s2*s3*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0))/a-1.0/(a*a*a)*m10*s2*s3*pow(a*a*a,1.0/3.0)*(2.8E1/9.0)-1.0/(a*a)*m01*s1*s2*s3*1.0/pow(a*a*a,1.0/3.0)*(1.6E1/9.0)+1.0/(a*a*a*a)*m10*s1*s2*s3*pow(a*a*a,1.0/3.0)*(1.6E1/9.0);
    }
}
//#####################################################################
// Function P_From_Strain
//#####################################################################
template<class T,int d> DIAGONAL_MATRIX<T,d> MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
P_From_Strain(const DIAGONAL_MATRIX<T,d>& F,const T scale,const int simplex) const
{
    return P_From_Strain_Helper(F,scale,simplex);
}
//#####################################################################
// Function P_From_Strain_Helper
//#####################################################################
template<class T,int d> DIAGONAL_MATRIX<T,2> MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
P_From_Strain_Helper(const DIAGONAL_MATRIX<T,2>& F,const T scale,const int simplex) const
{
    PHYSBAM_FATAL_ERROR();

}
//#####################################################################
// Function P_From_Strain_Helper
//#####################################################################
template<class T,int d> DIAGONAL_MATRIX<T,3> MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
P_From_Strain_Helper(const DIAGONAL_MATRIX<T,3>& F,const T scale,const int simplex) const
{
    T s1 = F.x11;
    T s2 = F.x22;
    T s3 = F.x33;
//    T x = F.x11;
 //   T y = F.x22;
  //  T z = F.x33;    
    T dx = s1 - extrapolation_cutoff;
    T dy = s2 - extrapolation_cutoff;
    T dz = s3 - extrapolation_cutoff;

  //  T mu = constant_mu;
  //  T la = constant_lambda;
    
    T a = extrapolation_cutoff;
    T k = extra_force_coefficient*youngs_modulus;
    T kap = kappa;
    T m10 = mu_10; T m01=mu_01;
    
    if ((dx >= 0) && (dy >= 0) && (dz >= 0)) // R
    {
                DIAGONAL_MATRIX<T,3> result;
        result.x11 = (m01*(s2*s2*s2)*(s3*s3*s3)*4.0+m10*s2*(s3*s3*s3)*pow(s1*s2*s3,2.0/3.0)*2.0+m10*(s2*s2*s2)*s3*pow(s1*s2*s3,2.0/3.0)*2.0)*1.0/pow(s1*s2*s3,7.0/3.0)*(-1.0/3.0)+(s1*s1)*(m01*s2*(s3*s3*s3)*2.0+m01*(s2*s2*s2)*s3*2.0+m10*s2*s3*pow(s1*s2*s3,2.0/3.0)*4.0)*1.0/pow(s1*s2*s3,7.0/3.0)*(1.0/3.0)+(kap*log(s1*s2*s3))/s1;
        result.x22 = (m01*(s1*s1*s1)*(s3*s3*s3)*4.0+m10*s1*(s3*s3*s3)*pow(s1*s2*s3,2.0/3.0)*2.0+m10*(s1*s1*s1)*s3*pow(s1*s2*s3,2.0/3.0)*2.0)*1.0/pow(s1*s2*s3,7.0/3.0)*(-1.0/3.0)+(s2*s2)*(m01*s1*(s3*s3*s3)*2.0+m01*(s1*s1*s1)*s3*2.0+m10*s1*s3*pow(s1*s2*s3,2.0/3.0)*4.0)*1.0/pow(s1*s2*s3,7.0/3.0)*(1.0/3.0)+(kap*log(s1*s2*s3))/s2;
        result.x33 = (m01*(s1*s1*s1)*(s2*s2*s2)*4.0+m10*s1*(s2*s2*s2)*pow(s1*s2*s3,2.0/3.0)*2.0+m10*(s1*s1*s1)*s2*pow(s1*s2*s3,2.0/3.0)*2.0)*1.0/pow(s1*s2*s3,7.0/3.0)*(-1.0/3.0)+(s3*s3)*(m01*s1*(s2*s2*s2)*2.0+m01*(s1*s1*s1)*s2*2.0+m10*s1*s2*pow(s1*s2*s3,2.0/3.0)*4.0)*1.0/pow(s1*s2*s3,7.0/3.0)*(1.0/3.0)+(kap*log(s1*s2*s3))/s3;
        
        return scale*result;
    }
    else if ((dx < 0) && (dy >= 0) && (dz >= 0)) // Rx
    {
        DIAGONAL_MATRIX<T,3> result;

        result.x11 = a*k*-2.0+k*s1*2.0+(kap*log(a*s2*s3))/a-m10*s2*(s3*s3*s3)*1.0/pow(a*s2*s3,5.0/3.0)*(2.0/3.0)-m10*(s2*s2*s2)*s3*1.0/pow(a*s2*s3,5.0/3.0)*(2.0/3.0)-m01*(s2*s2*s2)*(s3*s3*s3)*1.0/pow(a*s2*s3,7.0/3.0)*(4.0/3.0)+(a*a)*m10*s2*s3*1.0/pow(a*s2*s3,5.0/3.0)*(4.0/3.0)+(a*a)*m01*s2*(s3*s3*s3)*1.0/pow(a*s2*s3,7.0/3.0)*(2.0/3.0)+(a*a)*m01*(s2*s2*s2)*s3*1.0/pow(a*s2*s3,7.0/3.0)*(2.0/3.0);
        result.x22 = (s2*1.0/(s3*s3*s3*s3)*1.0/pow(a*s2*s3,1.0E1/3.0)*((a*a*a*a*a)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*8.0+(a*a*a)*m10*(s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0E1-(a*a*a*a*a)*m10*(s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0+(a*a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*1.6E1-(a*a)*m10*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*8.0+(a*a*a*a)*m10*s1*(s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.6E1)*(-1.0/1.8E1))/a+((s2*s2*s2)*1.0/(s3*s3*s3*s3)*1.0/pow(a*s2*s3,1.0E1/3.0)*((a*a*a)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*2.8E1+(a*a*a*a*a)*m01*(s3*s3*s3*s3*s3*s3)*4.0+(a*a*a)*m10*(s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0E1-(a*a)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*1.6E1+(a*a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3)*8.0-(a*a)*m10*s1*(s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.6E1)*(1.0/1.8E1))/a+((s2*s2)*1.0/(s3*s3*s3*s3)*((a*a*a*a)*kap*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*-1.8E1+(a*a*a*a)*kap*(s3*s3*s3*s3*s3*s3*s3)*log(a*s2*s3)*pow(a*s2*s3,1.0/3.0)*1.8E1+(a*a*a)*kap*s1*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*1.8E1)*1.0/pow(a*s2*s3,1.0E1/3.0)*(1.0/1.8E1))/a;
        result.x33 = ((s2*s2*s2*s2)*1.0/(s3*s3*s3*s3*s3)*1.0/pow(a*s2*s3,1.0E1/3.0)*((a*a*a)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*-2.8E1+(a*a*a*a*a)*m01*(s3*s3*s3*s3*s3*s3)*8.0+(a*a*a)*m10*(s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0E1+(a*a)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*1.6E1+(a*a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3)*1.6E1-(a*a)*m10*s1*(s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*8.0)*(-1.0/1.8E1))/a+((s2*s2)*1.0/(s3*s3*s3*s3*s3)*1.0/pow(a*s2*s3,1.0E1/3.0)*((a*a*a*a*a)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*4.0+(a*a*a)*m10*(s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0E1+(a*a*a*a*a)*m10*(s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0+(a*a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*8.0-(a*a)*m10*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.6E1-(a*a*a*a)*m10*s1*(s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.6E1)*(1.0/1.8E1))/a+((s2*s2*s2)*1.0/(s3*s3*s3*s3*s3)*((a*a*a*a)*kap*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*-1.8E1+(a*a*a*a)*kap*(s3*s3*s3*s3*s3*s3*s3)*log(a*s2*s3)*pow(a*s2*s3,1.0/3.0)*1.8E1+(a*a*a)*kap*s1*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*1.8E1)*1.0/pow(a*s2*s3,1.0E1/3.0)*(1.0/1.8E1))/a;


        return scale*result;
    }
    else if ((dx >= 0) && (dy < 0) && (dz >= 0)) // Ry
    {
        DIAGONAL_MATRIX<T,3> result;
        result.x11 = ((s1*s1)*((a*a*a*a)*kap*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*-9.0+(a*a*a*a)*kap*(s3*s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0+(a*a*a)*kap*s2*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0)*1.0/pow(a*s1*s3,1.0E1/3.0)*(1.0/9.0))/a-(s1*1.0/pow(a*s1*s3,1.0E1/3.0)*((a*a*a*a*a)*m01*(s3*s3*s3*s3)*4.0+(a*a*a)*m10*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*1.0E1-(a*a*a*a*a)*m10*(s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0+(a*a*a*a)*m01*s2*(s3*s3*s3*s3)*8.0-(a*a)*m10*s2*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*4.0+(a*a*a*a)*m10*s2*(s3*s3)*pow(a*s1*s3,2.0/3.0)*8.0)*(1.0/9.0))/a+((s1*s1*s1)*1.0/pow(a*s1*s3,1.0E1/3.0)*((a*a*a)*m01*(s3*s3*s3*s3)*1.4E1+(a*a*a*a*a)*m01*(s3*s3)*2.0+(a*a*a)*m10*(s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0E1-(a*a)*m01*s2*(s3*s3*s3*s3)*8.0+(a*a*a*a)*m01*s2*(s3*s3)*4.0-(a*a)*m10*s2*(s3*s3)*pow(a*s1*s3,2.0/3.0)*8.0)*(1.0/9.0))/a;
        result.x22 = a*k*-2.0+k*s2*2.0+(kap*log(a*s1*s3))/a-m10*s1*(s3*s3*s3)*1.0/pow(a*s1*s3,5.0/3.0)*(2.0/3.0)-m10*(s1*s1*s1)*s3*1.0/pow(a*s1*s3,5.0/3.0)*(2.0/3.0)-m01*(s1*s1*s1)*(s3*s3*s3)*1.0/pow(a*s1*s3,7.0/3.0)*(4.0/3.0)+(a*a)*m10*s1*s3*1.0/pow(a*s1*s3,5.0/3.0)*(4.0/3.0)+(a*a)*m01*s1*(s3*s3*s3)*1.0/pow(a*s1*s3,7.0/3.0)*(2.0/3.0)+(a*a)*m01*(s1*s1*s1)*s3*1.0/pow(a*s1*s3,7.0/3.0)*(2.0/3.0);
        result.x33 = ((s3*s3)*((a*a*a*a)*kap*(s1*s1*s1)*pow(a*s1*s3,1.0/3.0)*-9.0+(a*a*a*a)*kap*(s1*s1*s1)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0+(a*a*a)*kap*(s1*s1*s1)*s2*pow(a*s1*s3,1.0/3.0)*9.0)*1.0/pow(a*s1*s3,1.0E1/3.0)*(1.0/9.0))/a-(s3*1.0/pow(a*s1*s3,1.0E1/3.0)*((a*a*a*a*a)*m01*(s1*s1*s1*s1)*4.0+(a*a*a)*m10*(s1*s1*s1*s1)*pow(a*s1*s3,2.0/3.0)*1.0E1-(a*a*a*a*a)*m10*(s1*s1)*pow(a*s1*s3,2.0/3.0)*2.0+(a*a*a*a)*m01*(s1*s1*s1*s1)*s2*8.0-(a*a)*m10*(s1*s1*s1*s1)*s2*pow(a*s1*s3,2.0/3.0)*4.0+(a*a*a*a)*m10*(s1*s1)*s2*pow(a*s1*s3,2.0/3.0)*8.0)*(1.0/9.0))/a+((s3*s3*s3)*1.0/pow(a*s1*s3,1.0E1/3.0)*((a*a*a)*m01*(s1*s1*s1*s1)*1.4E1+(a*a*a*a*a)*m01*(s1*s1)*2.0+(a*a*a)*m10*(s1*s1)*pow(a*s1*s3,2.0/3.0)*2.0E1-(a*a)*m01*(s1*s1*s1*s1)*s2*8.0+(a*a*a*a)*m01*(s1*s1)*s2*4.0-(a*a)*m10*(s1*s1)*s2*pow(a*s1*s3,2.0/3.0)*8.0)*(1.0/9.0))/a;

        return scale*result;
    }
    else if ((dx >= 0) && (dy >= 0) && (dz < 0)) // Rz
    {
        DIAGONAL_MATRIX<T,3> result;
        result.x11 = ((s1*s1)*((a*a*a*a)*kap*(s2*s2*s2)*pow(a*s1*s2,1.0/3.0)*-9.0+(a*a*a*a)*kap*(s2*s2*s2)*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0+(a*a*a)*kap*(s2*s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*9.0)*1.0/pow(a*s1*s2,1.0E1/3.0)*(1.0/9.0))/a-(s1*1.0/pow(a*s1*s2,1.0E1/3.0)*((a*a*a*a*a)*m01*(s2*s2*s2*s2)*4.0+(a*a*a)*m10*(s2*s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*1.0E1-(a*a*a*a*a)*m10*(s2*s2)*pow(a*s1*s2,2.0/3.0)*2.0+(a*a*a*a)*m01*(s2*s2*s2*s2)*s3*8.0-(a*a)*m10*(s2*s2*s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*4.0+(a*a*a*a)*m10*(s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*8.0)*(1.0/9.0))/a+((s1*s1*s1)*1.0/pow(a*s1*s2,1.0E1/3.0)*((a*a*a)*m01*(s2*s2*s2*s2)*1.4E1+(a*a*a*a*a)*m01*(s2*s2)*2.0+(a*a*a)*m10*(s2*s2)*pow(a*s1*s2,2.0/3.0)*2.0E1-(a*a)*m01*(s2*s2*s2*s2)*s3*8.0+(a*a*a*a)*m01*(s2*s2)*s3*4.0-(a*a)*m10*(s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*8.0)*(1.0/9.0))/a;
        result.x22 = ((s2*s2)*((a*a*a*a)*kap*(s1*s1*s1)*pow(a*s1*s2,1.0/3.0)*-9.0+(a*a*a*a)*kap*(s1*s1*s1)*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0+(a*a*a)*kap*(s1*s1*s1)*s3*pow(a*s1*s2,1.0/3.0)*9.0)*1.0/pow(a*s1*s2,1.0E1/3.0)*(1.0/9.0))/a-(s2*1.0/pow(a*s1*s2,1.0E1/3.0)*((a*a*a*a*a)*m01*(s1*s1*s1*s1)*4.0+(a*a*a)*m10*(s1*s1*s1*s1)*pow(a*s1*s2,2.0/3.0)*1.0E1-(a*a*a*a*a)*m10*(s1*s1)*pow(a*s1*s2,2.0/3.0)*2.0+(a*a*a*a)*m01*(s1*s1*s1*s1)*s3*8.0-(a*a)*m10*(s1*s1*s1*s1)*s3*pow(a*s1*s2,2.0/3.0)*4.0+(a*a*a*a)*m10*(s1*s1)*s3*pow(a*s1*s2,2.0/3.0)*8.0)*(1.0/9.0))/a+((s2*s2*s2)*1.0/pow(a*s1*s2,1.0E1/3.0)*((a*a*a)*m01*(s1*s1*s1*s1)*1.4E1+(a*a*a*a*a)*m01*(s1*s1)*2.0+(a*a*a)*m10*(s1*s1)*pow(a*s1*s2,2.0/3.0)*2.0E1-(a*a)*m01*(s1*s1*s1*s1)*s3*8.0+(a*a*a*a)*m01*(s1*s1)*s3*4.0-(a*a)*m10*(s1*s1)*s3*pow(a*s1*s2,2.0/3.0)*8.0)*(1.0/9.0))/a;
        result.x33 = a*k*-2.0+k*s3*2.0+(kap*log(a*s1*s2))/a-m10*s1*(s2*s2*s2)*1.0/pow(a*s1*s2,5.0/3.0)*(2.0/3.0)-m10*(s1*s1*s1)*s2*1.0/pow(a*s1*s2,5.0/3.0)*(2.0/3.0)-m01*(s1*s1*s1)*(s2*s2*s2)*1.0/pow(a*s1*s2,7.0/3.0)*(4.0/3.0)+(a*a)*m10*s1*s2*1.0/pow(a*s1*s2,5.0/3.0)*(4.0/3.0)+(a*a)*m01*s1*(s2*s2*s2)*1.0/pow(a*s1*s2,7.0/3.0)*(2.0/3.0)+(a*a)*m01*(s1*s1*s1)*s2*1.0/pow(a*s1*s2,7.0/3.0)*(2.0/3.0);

        return scale*result;
    }
    else if ((dx < 0) && (dy < 0) && (dz >= 0)) // Rxy
    {
        DIAGONAL_MATRIX<T,3> result;
        result.x11 = a*k*-2.0+k*s1*2.0-kap/a+a*m10*1.0/pow((a*a)*s3,2.0/3.0)*(2.2E1/9.0)-m10*s2*1.0/pow((a*a)*s3,2.0/3.0)*(1.6E1/9.0)+(kap*log((a*a)*s3))/a+1.0/(a*a)*kap*s2+m10*s2*(s3*s3*s3)*1.0/pow((a*a)*s3,5.0/3.0)*(4.0/9.0)+pow(a,1.1E1)*m01*(s3*s3*s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(1.0E1/9.0)+pow(a,1.3E1)*m01*(s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(2.0/9.0)-a*m10*(s3*s3*s3)*1.0/pow((a*a)*s3,5.0/3.0)*(1.0E1/9.0)-pow(a,1.0E1)*m01*s2*(s3*s3*s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(1.6E1/9.0)+pow(a,1.2E1)*m01*s2*(s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(4.0/9.0);
        result.x22 = a*k*-2.0+k*s2*2.0-kap/a+a*m10*1.0/pow((a*a)*s3,2.0/3.0)*(2.2E1/9.0)-m10*s1*1.0/pow((a*a)*s3,2.0/3.0)*(1.6E1/9.0)+(kap*log((a*a)*s3))/a+1.0/(a*a)*kap*s1+m10*s1*(s3*s3*s3)*1.0/pow((a*a)*s3,5.0/3.0)*(4.0/9.0)+pow(a,1.1E1)*m01*(s3*s3*s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(1.0E1/9.0)+pow(a,1.3E1)*m01*(s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(2.0/9.0)-a*m10*(s3*s3*s3)*1.0/pow((a*a)*s3,5.0/3.0)*(1.0E1/9.0)-pow(a,1.0E1)*m01*s1*(s3*s3*s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(1.6E1/9.0)+pow(a,1.2E1)*m01*s1*(s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(4.0/9.0);
        result.x33 = (1.0/(s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(a*m10*pow((a*a)*s3,2.0E1/3.0)*2.0E1-m10*s1*pow((a*a)*s3,2.0E1/3.0)*4.4E1-m10*s2*pow((a*a)*s3,2.0E1/3.0)*4.4E1+pow(a,1.3E1)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*2.8E1-pow(a,1.5E1)*m01*(s3*s3*s3*s3*s3*s3)*4.0-m10*s1*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0E1-m10*s2*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0E1-a*kap*s3*pow((a*a)*s3,1.9E1/3.0)*5.4E1+kap*s1*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1+kap*s2*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1+pow(a,1.2E1)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1-pow(a,1.4E1)*m01*s1*(s3*s3*s3*s3*s3*s3)*8.0+pow(a,1.2E1)*m01*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1-pow(a,1.4E1)*m01*s2*(s3*s3*s3*s3*s3*s3)*8.0+a*m10*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*1.0E2-pow(a,1.1E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*3.2E1-pow(a,1.3E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3)*1.6E1+a*kap*s3*log((a*a)*s3)*pow((a*a)*s3,1.9E1/3.0)*2.7E1+a*m10*s1*s2*s3*pow((a*a)*s3,1.7E1/3.0)*3.2E1+a*m10*s1*s2*(s3*s3*s3*s3)*pow((a*a)*s3,1.4E1/3.0)*1.6E1)*(1.0/2.7E1))/a;

        return scale*result;
    }
    else if ((dx < 0) && (dy >= 0) && (dz < 0)) // Rzx
    {
        DIAGONAL_MATRIX<T,3> result;
        result.x11 = a*k*-2.0+k*s1*2.0-kap/a+a*m10*1.0/pow((a*a)*s2,2.0/3.0)*(2.2E1/9.0)-m10*s3*1.0/pow((a*a)*s2,2.0/3.0)*(1.6E1/9.0)+(kap*log((a*a)*s2))/a+1.0/(a*a)*kap*s3+m10*(s2*s2*s2)*s3*1.0/pow((a*a)*s2,5.0/3.0)*(4.0/9.0)+pow(a,1.1E1)*m01*(s2*s2*s2*s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(1.0E1/9.0)+pow(a,1.3E1)*m01*(s2*s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(2.0/9.0)-a*m10*(s2*s2*s2)*1.0/pow((a*a)*s2,5.0/3.0)*(1.0E1/9.0)-pow(a,1.0E1)*m01*(s2*s2*s2*s2*s2*s2*s2)*s3*1.0/pow((a*a)*s2,1.9E1/3.0)*(1.6E1/9.0)+pow(a,1.2E1)*m01*(s2*s2*s2*s2*s2)*s3*1.0/pow((a*a)*s2,1.9E1/3.0)*(4.0/9.0);
        result.x22 = (1.0/(s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(a*m10*pow((a*a)*s2,2.0E1/3.0)*2.0E1-m10*s1*pow((a*a)*s2,2.0E1/3.0)*4.4E1-m10*s3*pow((a*a)*s2,2.0E1/3.0)*4.4E1+pow(a,1.3E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*2.8E1-pow(a,1.5E1)*m01*(s2*s2*s2*s2*s2*s2)*4.0-m10*s1*(s2*s2*s2)*pow((a*a)*s2,1.7E1/3.0)*4.0E1-m10*(s2*s2*s2)*s3*pow((a*a)*s2,1.7E1/3.0)*4.0E1-a*kap*s2*pow((a*a)*s2,1.9E1/3.0)*5.4E1+kap*s1*s2*pow((a*a)*s2,1.9E1/3.0)*2.7E1+kap*s2*s3*pow((a*a)*s2,1.9E1/3.0)*2.7E1+pow(a,1.2E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*2.0E1-pow(a,1.4E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*8.0+pow(a,1.2E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*2.0E1-pow(a,1.4E1)*m01*(s2*s2*s2*s2*s2*s2)*s3*8.0+a*m10*(s2*s2*s2)*pow((a*a)*s2,1.7E1/3.0)*1.0E2-pow(a,1.1E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*3.2E1-pow(a,1.3E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*s3*1.6E1+a*kap*s2*log((a*a)*s2)*pow((a*a)*s2,1.9E1/3.0)*2.7E1+a*m10*s1*s2*s3*pow((a*a)*s2,1.7E1/3.0)*3.2E1+a*m10*s1*(s2*s2*s2*s2)*s3*pow((a*a)*s2,1.4E1/3.0)*1.6E1)*(1.0/2.7E1))/a;
        result.x33 = a*k*-2.0+k*s3*2.0-kap/a+a*m10*1.0/pow((a*a)*s2,2.0/3.0)*(2.2E1/9.0)-m10*s1*1.0/pow((a*a)*s2,2.0/3.0)*(1.6E1/9.0)+(kap*log((a*a)*s2))/a+1.0/(a*a)*kap*s1+m10*s1*(s2*s2*s2)*1.0/pow((a*a)*s2,5.0/3.0)*(4.0/9.0)+pow(a,1.1E1)*m01*(s2*s2*s2*s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(1.0E1/9.0)+pow(a,1.3E1)*m01*(s2*s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(2.0/9.0)-a*m10*(s2*s2*s2)*1.0/pow((a*a)*s2,5.0/3.0)*(1.0E1/9.0)-pow(a,1.0E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(1.6E1/9.0)+pow(a,1.2E1)*m01*s1*(s2*s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(4.0/9.0);

        return scale*result;
    }
    else if ((dx >= 0) && (dy < 0) && (dz < 0)) // Ryz
    {
        DIAGONAL_MATRIX<T,3> result;
        result.x11 = (1.0/pow((a*a)*s1,2.8E1/3.0)*(a*kap*pow((a*a)*s1,2.8E1/3.0)*5.4E1-kap*s2*pow((a*a)*s1,2.8E1/3.0)*2.7E1-kap*s3*pow((a*a)*s1,2.8E1/3.0)*2.7E1-pow(a,1.9E1)*m01*pow(s1,1.0E1)*2.8E1+pow(a,2.1E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*4.0-(a*a*a)*m10*pow((a*a)*s1,2.6E1/3.0)*2.0E1+m10*(s1*s1)*s2*pow((a*a)*s1,2.6E1/3.0)*4.0E1+m10*(s1*s1)*s3*pow((a*a)*s1,2.6E1/3.0)*4.0E1-a*kap*log((a*a)*s1)*pow((a*a)*s1,2.8E1/3.0)*2.7E1-pow(a,1.8E1)*m01*pow(s1,1.0E1)*s2*2.0E1+pow(a,2.0E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s2*8.0-pow(a,1.8E1)*m01*pow(s1,1.0E1)*s3*2.0E1+pow(a,2.0E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s3*8.0-a*m10*(s1*s1)*pow((a*a)*s1,2.6E1/3.0)*1.0E2+(a*a)*m10*s2*pow((a*a)*s1,2.6E1/3.0)*4.4E1+(a*a)*m10*s3*pow((a*a)*s1,2.6E1/3.0)*4.4E1-a*m10*s2*s3*pow((a*a)*s1,2.6E1/3.0)*3.2E1+pow(a,1.7E1)*m01*pow(s1,1.0E1)*s2*s3*3.2E1+pow(a,1.9E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s2*s3*1.6E1-a*m10*(s1*s1*s1)*s2*s3*pow((a*a)*s1,2.3E1/3.0)*1.6E1)*(-1.0/2.7E1))/(a*s1);
        result.x22 = a*k*-2.0+k*s2*2.0-kap/a+(kap*log((a*a)*s1))/a+1.0/(a*a)*kap*s3+m10*(s1*s1*s1)*s3*1.0/pow((a*a)*s1,5.0/3.0)*(4.0/9.0)+pow(a,1.7E1)*m01*pow(s1,1.0E1)*1.0/pow((a*a)*s1,2.8E1/3.0)*(1.0E1/9.0)+pow(a,1.9E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*1.0/pow((a*a)*s1,2.8E1/3.0)*(2.0/9.0)-a*m10*(s1*s1*s1)*1.0/pow((a*a)*s1,5.0/3.0)*(1.0E1/9.0)+(a*a*a)*m10*s1*1.0/pow((a*a)*s1,5.0/3.0)*(2.2E1/9.0)-(a*a)*m10*s1*s3*1.0/pow((a*a)*s1,5.0/3.0)*(1.6E1/9.0)-pow(a,1.6E1)*m01*pow(s1,1.0E1)*s3*1.0/pow((a*a)*s1,2.8E1/3.0)*(1.6E1/9.0)+pow(a,1.8E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s3*1.0/pow((a*a)*s1,2.8E1/3.0)*(4.0/9.0);
        result.x33 = a*k*-2.0+k*s3*2.0-kap/a+(kap*log((a*a)*s1))/a+1.0/(a*a)*kap*s2+m10*(s1*s1*s1)*s2*1.0/pow((a*a)*s1,5.0/3.0)*(4.0/9.0)+pow(a,1.7E1)*m01*pow(s1,1.0E1)*1.0/pow((a*a)*s1,2.8E1/3.0)*(1.0E1/9.0)+pow(a,1.9E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*1.0/pow((a*a)*s1,2.8E1/3.0)*(2.0/9.0)-a*m10*(s1*s1*s1)*1.0/pow((a*a)*s1,5.0/3.0)*(1.0E1/9.0)+(a*a*a)*m10*s1*1.0/pow((a*a)*s1,5.0/3.0)*(2.2E1/9.0)-(a*a)*m10*s1*s2*1.0/pow((a*a)*s1,5.0/3.0)*(1.6E1/9.0)-pow(a,1.6E1)*m01*pow(s1,1.0E1)*s2*1.0/pow((a*a)*s1,2.8E1/3.0)*(1.6E1/9.0)+pow(a,1.8E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s2*1.0/pow((a*a)*s1,2.8E1/3.0)*(4.0/9.0);

        return scale*result;
    }
    else // Rxyz
    {
        DIAGONAL_MATRIX<T,3> result;
        result.x11 = a*k*-2.0+k*s1*2.0-(kap*2.0)/a+m01*1.0/pow(a*a*a,1.0/3.0)*(8.0/9.0)+a*m10*1.0/pow(a*a*a,2.0/3.0)*(4.0E1/9.0)-m10*s2*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0)-m10*s3*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0)+(kap*log(a*a*a))/a+1.0/(a*a)*kap*s2+1.0/(a*a)*kap*s3+(m01*s2*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0))/a+(m01*s3*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0))/a-1.0/(a*a)*m01*s2*s3*1.0/pow(a*a*a,1.0/3.0)*(1.6E1/9.0)+(m10*s2*s3*1.0/pow(a*a*a,2.0/3.0)*(1.6E1/9.0))/a;
        result.x22 = a*k*-2.0+k*s2*2.0-(kap*2.0)/a+m01*1.0/pow(a*a*a,1.0/3.0)*(8.0/9.0)+a*m10*1.0/pow(a*a*a,2.0/3.0)*(4.0E1/9.0)-m10*s1*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0)-m10*s3*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0)+(kap*log(a*a*a))/a+1.0/(a*a)*kap*s1+1.0/(a*a)*kap*s3+(m01*s1*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0))/a+(m01*s3*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0))/a-1.0/(a*a)*m01*s1*s3*1.0/pow(a*a*a,1.0/3.0)*(1.6E1/9.0)+(m10*s1*s3*1.0/pow(a*a*a,2.0/3.0)*(1.6E1/9.0))/a;
        result.x33 = a*k*-2.0+k*s3*2.0-(kap*2.0)/a+m01*1.0/pow(a*a*a,1.0/3.0)*(8.0/9.0)+a*m10*1.0/pow(a*a*a,2.0/3.0)*(4.0E1/9.0)-m10*s1*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0)-m10*s2*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0)+(kap*log(a*a*a))/a+1.0/(a*a)*kap*s1+1.0/(a*a)*kap*s2+(m01*s1*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0))/a+(m01*s2*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0))/a-1.0/(a*a)*m01*s1*s2*1.0/pow(a*a*a,1.0/3.0)*(1.6E1/9.0)+(m10*s1*s2*1.0/pow(a*a*a,2.0/3.0)*(1.6E1/9.0))/a;

        return scale*result;
    }
}
//#####################################################################
// Function Isotropic_Stress_Derivative
//#####################################################################
template<class T,int d> void MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
Isotropic_Stress_Derivative(const DIAGONAL_MATRIX<T,d>& F,DIAGONALIZED_ISOTROPIC_STRESS_DERIVATIVE<T,d>& dP_dF,const int triangle) const
{
    return Isotropic_Stress_Derivative_Helper(F,dP_dF,triangle);
}
//#####################################################################
// Function Isotropic_Stress_Derivative_Helper
//#####################################################################
template<class T,int d> void MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
Isotropic_Stress_Derivative_Helper(const DIAGONAL_MATRIX<T,2>& F,DIAGONALIZED_ISOTROPIC_STRESS_DERIVATIVE<T,2>& dP_dF,const int triangle) const
{
    PHYSBAM_FATAL_ERROR();

}
//#####################################################################
// Function Isotropic_Stress_Derivative_Helper
//#####################################################################
template<class T,int d> void MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
Isotropic_Stress_Derivative_Helper(const DIAGONAL_MATRIX<T,3>& F,DIAGONALIZED_ISOTROPIC_STRESS_DERIVATIVE<T,3>& dP_dF,const int triangle) const
{
    
    T s1 = F.x11;
    T s2 = F.x22;
    T s3 = F.x33;
    
    T dx = s1 - extrapolation_cutoff;
    T dy = s2 - extrapolation_cutoff;
    T dz = s3 - extrapolation_cutoff;
    
    T a = extrapolation_cutoff;
    T k = extra_force_coefficient*youngs_modulus;
    T kap = kappa;
    T m10 = mu_10; T m01=mu_01;
    
    T s1ms3 = s1-s3; if(fabs(s1ms3)<panic_threshold) {s1=s1+1*panic_threshold; s3=s3+3*panic_threshold; s1ms3=s1-s3;}
    T s2ms3 = s2-s3; if(fabs(s2ms3)<panic_threshold) {s2=s2+2*panic_threshold; s3=s3+3*panic_threshold; s2ms3=s2-s3;}
    T s1ps2 = s1+s2; if(fabs(s1ps2)<panic_threshold) {s1=s1+1*panic_threshold; s2=s2+2*panic_threshold; s1ps2=s1+s2;}
    T s1ps3 = s1+s3; if(fabs(s1ps3)<panic_threshold) {s1=s1+1*panic_threshold; s3=s3+3*panic_threshold; s1ps3=s1+s3;}
    T s2ps3 = s2+s3; if(fabs(s2ps3)<panic_threshold) {s2=s2+2*panic_threshold; s3=s3+3*panic_threshold; s2ps3=s2+s3;}
    T s1ms2 = s1-s2; if(fabs(s1ms2)<panic_threshold) {s1=s1+1*panic_threshold; s2=s2+2*panic_threshold; s1ms2=s1-s2;}

    if ((dx >= 0) && (dy >= 0) && (dz >= 0)) // R
    {

        dP_dF.x1111 = (1.0/(s1*s1*s1)*(kap*s1*s2*pow(s1*s2*s3,1.0/3.0)*9.0-kap*s1*s2*log(s1*s2*s3)*pow(s1*s2*s3,1.0/3.0)*9.0)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/9.0))/s2+(1.0/(s1*s1*s1)*s3*(m01*(s1*s1)*-2.0+m01*(s2*s2)*2.8E1+m10*pow(s1*s2*s3,2.0/3.0)*1.0E1)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/9.0))/s2+(1.0/(s1*s1*s1)*(m01*(s1*s1)*(s2*s2)*-2.0+m10*(s1*s1)*pow(s1*s2*s3,2.0/3.0)*4.0+m10*(s2*s2)*pow(s1*s2*s3,2.0/3.0)*1.0E1)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/9.0))/(s2*s3);
        dP_dF.x2222 = kap*1.0/(s2*s2)-kap*1.0/(s2*s2)*log(s1*s2*s3)+m01*(s1*s1*s1*s1)*(s3*s3*s3*s3)*1.0/pow(s1*s2*s3,1.0E1/3.0)*(2.8E1/9.0)+m10*(s1*s1)*(s3*s3*s3*s3)*1.0/pow(s1*s2*s3,8.0/3.0)*(1.0E1/9.0)+m10*(s1*s1*s1*s1)*(s3*s3)*1.0/pow(s1*s2*s3,8.0/3.0)*(1.0E1/9.0)-m01*(s1*s1)*(s2*s2)*(s3*s3*s3*s3)*1.0/pow(s1*s2*s3,1.0E1/3.0)*(2.0/9.0)-m01*(s1*s1*s1*s1)*(s2*s2)*(s3*s3)*1.0/pow(s1*s2*s3,1.0E1/3.0)*(2.0/9.0)+m10*(s1*s1)*(s2*s2)*(s3*s3)*1.0/pow(s1*s2*s3,8.0/3.0)*(4.0/9.0);
        dP_dF.x3333 = kap*1.0/(s3*s3)-kap*1.0/(s3*s3)*log(s1*s2*s3)+m01*(s1*s1*s1*s1)*(s2*s2*s2*s2)*1.0/pow(s1*s2*s3,1.0E1/3.0)*(2.8E1/9.0)+m10*(s1*s1)*(s2*s2*s2*s2)*1.0/pow(s1*s2*s3,8.0/3.0)*(1.0E1/9.0)+m10*(s1*s1*s1*s1)*(s2*s2)*1.0/pow(s1*s2*s3,8.0/3.0)*(1.0E1/9.0)-m01*(s1*s1)*(s2*s2*s2*s2)*(s3*s3)*1.0/pow(s1*s2*s3,1.0E1/3.0)*(2.0/9.0)-m01*(s1*s1*s1*s1)*(s2*s2)*(s3*s3)*1.0/pow(s1*s2*s3,1.0E1/3.0)*(2.0/9.0)+m10*(s1*s1)*(s2*s2)*(s3*s3)*1.0/pow(s1*s2*s3,8.0/3.0)*(4.0/9.0);
        dP_dF.x2211 = -(1.0/(s1*s1)*1.0/(s2*s2)*((m01*(s1*s1)*(s3*s3)*8.0+m10*(s1*s1)*pow(s1*s2*s3,2.0/3.0)*8.0-m10*(s3*s3)*pow(s1*s2*s3,2.0/3.0)*4.0)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/9.0)-kap*s1*s2*s3))/s3-(1.0/(s1*s1)*(m01*(s1*s1)*-4.0+m01*(s3*s3)*8.0+m10*pow(s1*s2*s3,2.0/3.0)*8.0)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/9.0))/s3;
        dP_dF.x3311 = -(1.0/(s1*s1)*1.0/(s3*s3)*((m01*(s1*s1)*(s2*s2)*8.0+m10*(s1*s1)*pow(s1*s2*s3,2.0/3.0)*8.0-m10*(s2*s2)*pow(s1*s2*s3,2.0/3.0)*4.0)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/9.0)-kap*s1*s2*s3))/s2-(1.0/(s1*s1)*(m01*(s1*s1)*-4.0+m01*(s2*s2)*8.0+m10*pow(s1*s2*s3,2.0/3.0)*8.0)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/9.0))/s2;
        dP_dF.x3322 = 1.0/pow(s1*s2*s3,1.0E1/3.0)*(m01*(s1*s1)*(s2*s2*s2)*(s3*s3*s3)*-4.0+m01*(s1*s1*s1*s1)*s2*(s3*s3*s3)*8.0+m01*(s1*s1*s1*s1)*(s2*s2*s2)*s3*8.0-kap*(s1*s1*s1)*(s2*s2)*(s3*s3)*pow(s1*s2*s3,1.0/3.0)*9.0-m10*(s1*s1*s1*s1)*s2*s3*pow(s1*s2*s3,2.0/3.0)*4.0+m10*(s1*s1)*s2*(s3*s3*s3)*pow(s1*s2*s3,2.0/3.0)*8.0+m10*(s1*s1)*(s2*s2*s2)*s3*pow(s1*s2*s3,2.0/3.0)*8.0)*(-1.0/9.0);
        dP_dF.x2121 = ((m01*(s3*s3)*2.0+m10*pow(s1*s2*s3,2.0/3.0)*2.0)*1.0/pow(s1*s2*s3,1.0/3.0))/(s1*s2*s3);
        dP_dF.x3131 = ((m01*(s2*s2)*2.0+m10*pow(s1*s2*s3,2.0/3.0)*2.0)*1.0/pow(s1*s2*s3,1.0/3.0))/(s1*s2*s3);
        dP_dF.x3232 = m10*1.0/pow(s1*s2*s3,2.0/3.0)*2.0+m01*1.0/(s2*s2)*1.0/(s3*s3)*pow(s1*s2*s3,2.0/3.0)*2.0;
        dP_dF.x2112 = (1.0/(s1*s1)*1.0/(s2*s2)*((m01*(s1*s1)*(s3*s3)*4.0+m10*(s1*s1)*pow(s1*s2*s3,2.0/3.0)*2.0+m10*(s3*s3)*pow(s1*s2*s3,2.0/3.0)*2.0)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/3.0)-kap*s1*s2*s3*log(s1*s2*s3)))/s3+(1.0/(s1*s1)*(m01*(s1*s1)*-2.0+m01*(s3*s3)*4.0+m10*pow(s1*s2*s3,2.0/3.0)*2.0)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/3.0))/s3;
        dP_dF.x3113 = (1.0/(s1*s1)*1.0/(s3*s3)*((m01*(s2*s2)*(s3*s3)*4.0+m10*(s2*s2)*pow(s1*s2*s3,2.0/3.0)*2.0+m10*(s3*s3)*pow(s1*s2*s3,2.0/3.0)*2.0)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/3.0)-kap*s1*s2*s3*log(s1*s2*s3)))/s2+(1.0/(s3*s3)*(m01*(s2*s2)*4.0-m01*(s3*s3)*2.0+m10*pow(s1*s2*s3,2.0/3.0)*2.0)*1.0/pow(s1*s2*s3,1.0/3.0)*(1.0/3.0))/s2;
        dP_dF.x3223 = 1.0/pow(s1*s2*s3,7.0/3.0)*(m01*(s1*s1*s1)*(s2*s2)*4.0+m01*(s1*s1*s1)*(s3*s3)*4.0+m10*(s1*s1*s1)*pow(s1*s2*s3,2.0/3.0)*2.0+m10*s1*(s2*s2)*pow(s1*s2*s3,2.0/3.0)*2.0+m10*s1*(s3*s3)*pow(s1*s2*s3,2.0/3.0)*2.0-m01*s1*(s2*s2)*(s3*s3)*2.0-kap*(s1*s1)*s2*s3*log(s1*s2*s3)*pow(s1*s2*s3,1.0/3.0)*3.0)*(1.0/3.0);
    }
    else if ((dx < 0) && (dy >= 0) && (dz >= 0)) // Rx
    {
        dP_dF.x1111 = k*2.0;
        dP_dF.x2222 = (s2*1.0/(s3*s3*s3*s3)*1.0/pow(a*s2*s3,1.3E1/3.0)*((a*a*a*a*a*a)*m01*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*5.6E1+(a*a*a*a)*m10*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.0E2-(a*a*a*a*a*a)*m10*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0E1+(a*a*a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*1.12E2-(a*a*a)*m10*s1*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0E1+(a*a*a*a*a)*m10*s1*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*8.0E1)*(1.0/5.4E1))/a-((s2*s2*s2)*1.0/(s3*s3*s3*s3)*1.0/pow(a*s2*s3,1.3E1/3.0)*((a*a*a*a)*m01*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*2.8E1+(a*a*a*a*a*a)*m01*(s3*s3*s3*s3*s3*s3*s3)*4.0-(a*a*a*a)*m10*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0E1-(a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*1.6E1+(a*a*a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3*s3)*8.0+(a*a*a)*m10*s1*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.6E1)*(1.0/5.4E1))/a-((s2*s2)*1.0/(s3*s3*s3*s3)*((a*a*a*a*a)*kap*(s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*-1.08E2+(a*a*a*a*a)*kap*(s3*s3*s3*s3*s3*s3*s3*s3)*log(a*s2*s3)*pow(a*s2*s3,1.0/3.0)*5.4E1+(a*a*a*a)*kap*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*5.4E1)*1.0/pow(a*s2*s3,1.3E1/3.0)*(1.0/5.4E1))/a;
        dP_dF.x3333 = ((s2*s2*s2*s2*s2)*1.0/(s3*s3*s3*s3*s3*s3)*1.0/pow(a*s2*s3,1.3E1/3.0)*((a*a*a*a)*m01*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*-2.8E1+(a*a*a*a*a*a)*m01*(s3*s3*s3*s3*s3*s3*s3)*5.6E1+(a*a*a*a)*m10*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.0E2+(a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*1.6E1+(a*a*a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3*s3)*1.12E2-(a*a*a)*m10*s1*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0E1)*(1.0/5.4E1))/a-((s2*s2*s2)*1.0/(s3*s3*s3*s3*s3*s3)*1.0/pow(a*s2*s3,1.3E1/3.0)*((a*a*a*a*a*a)*m01*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*4.0-(a*a*a*a)*m10*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0E1+(a*a*a*a*a*a)*m10*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0E1+(a*a*a*a*a)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*8.0+(a*a*a)*m10*s1*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.6E1-(a*a*a*a*a)*m10*s1*(s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*8.0E1)*(1.0/5.4E1))/a-((s2*s2*s2*s2)*1.0/(s3*s3*s3*s3*s3*s3)*((a*a*a*a*a)*kap*(s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*-1.08E2+(a*a*a*a*a)*kap*(s3*s3*s3*s3*s3*s3*s3*s3)*log(a*s2*s3)*pow(a*s2*s3,1.0/3.0)*5.4E1+(a*a*a*a)*kap*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*5.4E1)*1.0/pow(a*s2*s3,1.3E1/3.0)*(1.0/5.4E1))/a;
        dP_dF.x2211 = (1.0/(a*a)*((a*a)*m01*-4.0+m01*(s3*s3)*8.0+m10*pow(a*s2*s3,2.0/3.0)*8.0)*1.0/pow(a*s2*s3,1.0/3.0)*(-1.0/9.0))/s3-(1.0/(a*a)*1.0/(s2*s2)*(1.0/pow(a*s2*s3,1.0/3.0)*((a*a)*m01*(s3*s3)*8.0+(a*a)*m10*pow(a*s2*s3,2.0/3.0)*8.0-m10*(s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0)*(1.0/9.0)-a*kap*s2*s3))/s3;
        dP_dF.x3311 = (1.0/(a*a)*((a*a)*m01*-4.0+m01*(s2*s2)*8.0+m10*pow(a*s2*s3,2.0/3.0)*8.0)*1.0/pow(a*s2*s3,1.0/3.0)*(-1.0/9.0))/s2-(1.0/(a*a)*1.0/(s3*s3)*(1.0/pow(a*s2*s3,1.0/3.0)*((a*a)*m01*(s2*s2)*8.0+(a*a)*m10*pow(a*s2*s3,2.0/3.0)*8.0-m10*(s2*s2)*pow(a*s2*s3,2.0/3.0)*4.0)*(1.0/9.0)-a*kap*s2*s3))/s2;
        dP_dF.x3322 = kap/(s2*s3)-((s2*s2*s2*s2)*1.0/pow(a*s2*s3,1.3E1/3.0)*((a*a*a)*m01*(s3*s3*s3*s3*s3)*-2.8E1+(a*a*a*a*a)*m01*(s3*s3*s3)*8.0+(a*a*a)*m10*(s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0E1+(a*a)*m01*s1*(s3*s3*s3*s3*s3)*1.6E1+(a*a*a*a)*m01*s1*(s3*s3*s3)*1.6E1-(a*a)*m10*s1*(s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.6E1)*(1.0/2.7E1))/s3-((s2*s2)*1.0/pow(a*s2*s3,1.3E1/3.0)*((a*a*a*a*a)*m01*(s3*s3*s3*s3*s3)*8.0+(a*a*a)*m10*(s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0E1+(a*a*a*a*a)*m10*(s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0+(a*a*a*a)*m01*s1*(s3*s3*s3*s3*s3)*1.6E1-(a*a)*m10*s1*(s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.6E1-(a*a*a*a)*m10*s1*(s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.6E1)*(1.0/2.7E1))/s3;
        dP_dF.x2121 = ((a*a*a)*m01*(s2*s2)*2.0-(a*a*a)*m01*(s3*s3)*4.0+(a*a*a)*m10*pow(a*s2*s3,2.0/3.0)*2.0-(a*a)*m10*s1*pow(a*s2*s3,2.0/3.0)*2.0E1+a*m10*(s2*s2)*pow(a*s2*s3,2.0/3.0)*2.0E1-a*m10*(s3*s3)*pow(a*s2*s3,2.0/3.0)*1.0E1-m10*s1*(s2*s2)*pow(a*s2*s3,2.0/3.0)*2.0+m10*s1*(s3*s3)*pow(a*s2*s3,2.0/3.0)*1.0E1-(a*a)*m01*s1*(s2*s2)*2.0-(a*a)*m01*s1*(s3*s3)*1.4E1+a*m01*(s2*s2)*(s3*s3)*1.4E1+m01*s1*(s2*s2)*(s3*s3)*4.0)/((a*a)*(s2*s2*s2)*s3*pow(a*s2*s3,1.0/3.0)*9.0-(a*a)*(s1*s1)*s2*s3*pow(a*s2*s3,1.0/3.0)*9.0)-((a*a)*kap*s2*s3*9.0+(a*a)*k*(s1*s1)*s2*s3*1.8E1-(a*a)*kap*s2*s3*log(a*s2*s3)*9.0-a*kap*s1*s2*s3*9.0-(a*a*a)*k*s1*s2*s3*1.8E1+a*kap*s1*s2*s3*log(a*s2*s3)*9.0)/((a*a)*(s2*s2*s2)*s3*9.0-(a*a)*(s1*s1)*s2*s3*9.0);
        dP_dF.x3131 = -((a*a*a)*m01*(s2*s2)*4.0-(a*a*a)*m01*(s3*s3)*2.0-(a*a*a)*m10*pow(a*s2*s3,2.0/3.0)*2.0+(a*a)*m10*s1*pow(a*s2*s3,2.0/3.0)*2.0E1+a*m10*(s2*s2)*pow(a*s2*s3,2.0/3.0)*1.0E1-a*m10*(s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0E1-m10*s1*(s2*s2)*pow(a*s2*s3,2.0/3.0)*1.0E1+m10*s1*(s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0+(a*a)*m01*s1*(s2*s2)*1.4E1+(a*a)*m01*s1*(s3*s3)*2.0-a*m01*(s2*s2)*(s3*s3)*1.4E1-m01*s1*(s2*s2)*(s3*s3)*4.0)/((a*a)*s2*(s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*9.0-(a*a)*(s1*s1)*s2*s3*pow(a*s2*s3,1.0/3.0)*9.0)-((a*a)*kap*s2*s3*9.0+(a*a)*k*(s1*s1)*s2*s3*1.8E1-(a*a)*kap*s2*s3*log(a*s2*s3)*9.0-a*kap*s1*s2*s3*9.0-(a*a*a)*k*s1*s2*s3*1.8E1+a*kap*s1*s2*s3*log(a*s2*s3)*9.0)/((a*a)*s2*(s3*s3*s3)*9.0-(a*a)*(s1*s1)*s2*s3*9.0);
        dP_dF.x3232 = 1.0/pow(a*s2*s3,5.0/3.0)*((a*a)*m01*pow(a*s2*s3,1.0/3.0)*2.0+a*m10*s2*s3*1.0E1-m10*s1*s2*s3*4.0+a*m01*s1*pow(a*s2*s3,1.0/3.0)*4.0)*(1.0/3.0);
        dP_dF.x2112 = ((a*a*a)*m01*(s2*s2*s2)*(s3*s3*s3*s3)*6.0+(a*a*a)*m01*(s2*s2*s2*s2*s2)*(s3*s3)*6.0-a*m01*(s2*s2*s2*s2*s2)*(s3*s3*s3*s3)*1.2E1-(a*a*a)*m01*(s1*s1)*(s2*s2*s2)*(s3*s3)*4.0-(a*a*a*a)*k*(s2*s2*s2*s2)*(s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*1.8E1+(a*a*a)*m10*(s2*s2*s2)*(s3*s3)*pow(a*s2*s3,2.0/3.0)*1.2E1+(a*a*a*a)*m01*s1*s2*(s3*s3*s3*s3)*4.0+a*m01*(s1*s1)*(s2*s2*s2)*(s3*s3*s3*s3)*8.0-(a*a)*m01*s1*(s2*s2*s2)*(s3*s3*s3*s3)*1.4E1+(a*a*a)*m01*(s1*s1)*s2*(s3*s3*s3*s3)*8.0-(a*a*a*a)*m01*s1*(s2*s2*s2)*(s3*s3)*2.0-a*m10*(s2*s2*s2)*(s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*6.0-a*m10*(s2*s2*s2*s2*s2)*(s3*s3)*pow(a*s2*s3,2.0/3.0)*6.0-(a*a)*kap*(s1*s1)*(s2*s2)*(s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*9.0+(a*a)*kap*(s2*s2*s2*s2)*(s3*s3*s3)*log(a*s2*s3)*pow(a*s2*s3,1.0/3.0)*9.0-a*m10*(s1*s1)*s2*(s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0+(a*a)*m10*s1*s2*(s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.0E1-(a*a*a*a)*m10*s1*s2*(s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0+(a*a*a)*k*s1*(s2*s2*s2*s2)*(s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*1.8E1+(a*a*a)*kap*s1*(s2*s2)*(s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*9.0+a*m10*(s1*s1)*(s2*s2*s2)*(s3*s3)*pow(a*s2*s3,2.0/3.0)*8.0-(a*a)*m10*s1*(s2*s2*s2)*(s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0E1+(a*a*a)*m10*(s1*s1)*s2*(s3*s3)*pow(a*s2*s3,2.0/3.0)*8.0-(a*a*a)*kap*s1*(s2*s2)*(s3*s3*s3)*log(a*s2*s3)*pow(a*s2*s3,1.0/3.0)*9.0)/((s1*s1)*pow(a*s2*s3,1.0E1/3.0)*9.0-(s2*s2)*pow(a*s2*s3,1.0E1/3.0)*9.0);
        dP_dF.x3113 = ((a*a*a)*m01*(s2*s2)*(s3*s3*s3*s3*s3)*6.0+(a*a*a)*m01*(s2*s2*s2*s2)*(s3*s3*s3)*6.0-a*m01*(s2*s2*s2*s2)*(s3*s3*s3*s3*s3)*1.2E1-(a*a*a)*m01*(s1*s1)*(s2*s2)*(s3*s3*s3)*4.0-(a*a*a*a)*k*(s2*s2*s2)*(s3*s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*1.8E1+(a*a*a)*m10*(s2*s2)*(s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.2E1+(a*a*a*a)*m01*s1*(s2*s2*s2*s2)*s3*4.0+a*m01*(s1*s1)*(s2*s2*s2*s2)*(s3*s3*s3)*8.0-(a*a)*m01*s1*(s2*s2*s2*s2)*(s3*s3*s3)*1.4E1+(a*a*a)*m01*(s1*s1)*(s2*s2*s2*s2)*s3*8.0-(a*a*a*a)*m01*s1*(s2*s2)*(s3*s3*s3)*2.0-a*m10*(s2*s2)*(s3*s3*s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*6.0-a*m10*(s2*s2*s2*s2)*(s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*6.0-(a*a)*kap*(s1*s1)*(s2*s2*s2)*(s3*s3)*pow(a*s2*s3,1.0/3.0)*9.0+(a*a)*kap*(s2*s2*s2)*(s3*s3*s3*s3)*log(a*s2*s3)*pow(a*s2*s3,1.0/3.0)*9.0-a*m10*(s1*s1)*(s2*s2*s2*s2)*s3*pow(a*s2*s3,2.0/3.0)*4.0+(a*a)*m10*s1*(s2*s2*s2*s2)*s3*pow(a*s2*s3,2.0/3.0)*1.0E1-(a*a*a*a)*m10*s1*(s2*s2)*s3*pow(a*s2*s3,2.0/3.0)*2.0+(a*a*a)*k*s1*(s2*s2*s2)*(s3*s3*s3*s3)*pow(a*s2*s3,1.0/3.0)*1.8E1+(a*a*a)*kap*s1*(s2*s2*s2)*(s3*s3)*pow(a*s2*s3,1.0/3.0)*9.0+a*m10*(s1*s1)*(s2*s2)*(s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*8.0-(a*a)*m10*s1*(s2*s2)*(s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*2.0E1+(a*a*a)*m10*(s1*s1)*(s2*s2)*s3*pow(a*s2*s3,2.0/3.0)*8.0-(a*a*a)*kap*s1*(s2*s2*s2)*(s3*s3)*log(a*s2*s3)*pow(a*s2*s3,1.0/3.0)*9.0)/((s1*s1)*pow(a*s2*s3,1.0E1/3.0)*9.0-(s3*s3)*pow(a*s2*s3,1.0E1/3.0)*9.0);
        dP_dF.x3223 = 1.0/pow(a*s2*s3,1.0E1/3.0)*((a*a)*m01*(s2*s2*s2)*(s3*s3*s3)*-1.4E1+(a*a*a*a)*m01*s2*(s3*s3*s3)*4.0+(a*a*a*a)*m01*(s2*s2*s2)*s3*4.0+(a*a*a)*kap*(s2*s2)*(s3*s3)*pow(a*s2*s3,1.0/3.0)*9.0+a*m01*s1*(s2*s2*s2)*(s3*s3*s3)*8.0+(a*a*a)*m01*s1*s2*(s3*s3*s3)*8.0+(a*a*a)*m01*s1*(s2*s2*s2)*s3*8.0-(a*a*a*a)*m10*s2*s3*pow(a*s2*s3,2.0/3.0)*2.0+(a*a)*m10*s2*(s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*1.0E1+(a*a)*m10*(s2*s2*s2)*s3*pow(a*s2*s3,2.0/3.0)*1.0E1-(a*a*a)*kap*(s2*s2)*(s3*s3)*log(a*s2*s3)*pow(a*s2*s3,1.0/3.0)*9.0-(a*a)*kap*s1*(s2*s2)*(s3*s3)*pow(a*s2*s3,1.0/3.0)*9.0-a*m10*s1*s2*(s3*s3*s3)*pow(a*s2*s3,2.0/3.0)*4.0-a*m10*s1*(s2*s2*s2)*s3*pow(a*s2*s3,2.0/3.0)*4.0+(a*a*a)*m10*s1*s2*s3*pow(a*s2*s3,2.0/3.0)*8.0)*(1.0/9.0);

    }
    else if ((dx >= 0) && (dy < 0) && (dz >= 0)) // Ry
    {
        dP_dF.x1111 = ((s1*s1)*((a*a*a*a*a)*kap*(s3*s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*-5.4E1+(a*a*a*a*a)*kap*(s3*s3*s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*2.7E1+(a*a*a*a)*kap*s2*(s3*s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*2.7E1)*1.0/pow(a*s1*s3,1.3E1/3.0)*(-1.0/2.7E1))/a+(s1*1.0/pow(a*s1*s3,1.3E1/3.0)*((a*a*a*a*a*a)*m01*(s3*s3*s3*s3*s3)*2.8E1+(a*a*a*a)*m10*(s3*s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*5.0E1-(a*a*a*a*a*a)*m10*(s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*1.0E1+(a*a*a*a*a)*m01*s2*(s3*s3*s3*s3*s3)*5.6E1-(a*a*a)*m10*s2*(s3*s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0E1+(a*a*a*a*a)*m10*s2*(s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*4.0E1)*(1.0/2.7E1))/a-((s1*s1*s1)*1.0/pow(a*s1*s3,1.3E1/3.0)*((a*a*a*a)*m01*(s3*s3*s3*s3*s3)*1.4E1+(a*a*a*a*a*a)*m01*(s3*s3*s3)*2.0-(a*a*a*a)*m10*(s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0E1-(a*a*a)*m01*s2*(s3*s3*s3*s3*s3)*8.0+(a*a*a*a*a)*m01*s2*(s3*s3*s3)*4.0+(a*a*a)*m10*s2*(s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*8.0)*(1.0/2.7E1))/a;
        dP_dF.x2222 = k*2.0;
        dP_dF.x3333 = ((s3*s3)*((a*a*a*a*a)*kap*(s1*s1*s1*s1)*pow(a*s1*s3,1.0/3.0)*-5.4E1+(a*a*a*a*a)*kap*(s1*s1*s1*s1)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*2.7E1+(a*a*a*a)*kap*(s1*s1*s1*s1)*s2*pow(a*s1*s3,1.0/3.0)*2.7E1)*1.0/pow(a*s1*s3,1.3E1/3.0)*(-1.0/2.7E1))/a+(s3*1.0/pow(a*s1*s3,1.3E1/3.0)*((a*a*a*a*a*a)*m01*(s1*s1*s1*s1*s1)*2.8E1+(a*a*a*a)*m10*(s1*s1*s1*s1*s1)*pow(a*s1*s3,2.0/3.0)*5.0E1-(a*a*a*a*a*a)*m10*(s1*s1*s1)*pow(a*s1*s3,2.0/3.0)*1.0E1+(a*a*a*a*a)*m01*(s1*s1*s1*s1*s1)*s2*5.6E1-(a*a*a)*m10*(s1*s1*s1*s1*s1)*s2*pow(a*s1*s3,2.0/3.0)*2.0E1+(a*a*a*a*a)*m10*(s1*s1*s1)*s2*pow(a*s1*s3,2.0/3.0)*4.0E1)*(1.0/2.7E1))/a-((s3*s3*s3)*1.0/pow(a*s1*s3,1.3E1/3.0)*((a*a*a*a)*m01*(s1*s1*s1*s1*s1)*1.4E1+(a*a*a*a*a*a)*m01*(s1*s1*s1)*2.0-(a*a*a*a)*m10*(s1*s1*s1)*pow(a*s1*s3,2.0/3.0)*2.0E1-(a*a*a)*m01*(s1*s1*s1*s1*s1)*s2*8.0+(a*a*a*a*a)*m01*(s1*s1*s1)*s2*4.0+(a*a*a)*m10*(s1*s1*s1)*s2*pow(a*s1*s3,2.0/3.0)*8.0)*(1.0/2.7E1))/a;
        dP_dF.x2211 = kap/(a*s1)-(a*1.0/pow(a*s1*s3,1.0E1/3.0)*(m01*(s1*s1*s1*s1)*(s3*s3*s3*s3)*8.0-m10*(s1*s1)*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*4.0+m10*(s1*s1*s1*s1)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*8.0)*(1.0/9.0))/s1-((a*a*a)*1.0/pow(a*s1*s3,1.0E1/3.0)*(m01*(s1*s1)*(s3*s3*s3*s3)*8.0-m01*(s1*s1*s1*s1)*(s3*s3)*4.0+m10*(s1*s1)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*8.0)*(1.0/9.0))/s1;
        dP_dF.x3311 = kap/(s1*s3)-((s3*s3*s3*s3)*1.0/pow(a*s1*s3,1.3E1/3.0)*((a*a*a)*m01*(s1*s1*s1*s1*s1)*-2.8E1+(a*a*a*a*a)*m01*(s1*s1*s1)*8.0+(a*a*a)*m10*(s1*s1*s1)*pow(a*s1*s3,2.0/3.0)*4.0E1+(a*a)*m01*(s1*s1*s1*s1*s1)*s2*1.6E1+(a*a*a*a)*m01*(s1*s1*s1)*s2*1.6E1-(a*a)*m10*(s1*s1*s1)*s2*pow(a*s1*s3,2.0/3.0)*1.6E1)*(1.0/2.7E1))/s1-((s3*s3)*1.0/pow(a*s1*s3,1.3E1/3.0)*((a*a*a*a*a)*m01*(s1*s1*s1*s1*s1)*8.0+(a*a*a)*m10*(s1*s1*s1*s1*s1)*pow(a*s1*s3,2.0/3.0)*4.0E1+(a*a*a*a*a)*m10*(s1*s1*s1)*pow(a*s1*s3,2.0/3.0)*4.0+(a*a*a*a)*m01*(s1*s1*s1*s1*s1)*s2*1.6E1-(a*a)*m10*(s1*s1*s1*s1*s1)*s2*pow(a*s1*s3,2.0/3.0)*1.6E1-(a*a*a*a)*m10*(s1*s1*s1)*s2*pow(a*s1*s3,2.0/3.0)*1.6E1)*(1.0/2.7E1))/s1;
        dP_dF.x3322 = kap/(a*s3)-(a*1.0/pow(a*s1*s3,1.0E1/3.0)*(m01*(s1*s1*s1*s1)*(s3*s3*s3*s3)*8.0+m10*(s1*s1)*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*8.0-m10*(s1*s1*s1*s1)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*4.0)*(1.0/9.0))/s3-((a*a*a)*1.0/pow(a*s1*s3,1.0E1/3.0)*(m01*(s1*s1)*(s3*s3*s3*s3)*-4.0+m01*(s1*s1*s1*s1)*(s3*s3)*8.0+m10*(s1*s1)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*8.0)*(1.0/9.0))/s3;
        dP_dF.x2121 = ((a*a)*m01*(s1*s1*s1*s1)*(s3*s3*s3*s3)*1.4E1-(a*a*a*a)*m01*(s1*s1)*(s3*s3*s3*s3)*4.0+(a*a*a*a)*m01*(s1*s1*s1*s1)*(s3*s3)*2.0-(a*a*a)*kap*(s1*s1*s1)*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0-(a*a)*m10*(s1*s1)*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*1.0E1+(a*a)*m10*(s1*s1*s1*s1)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0E1+(a*a*a*a)*m10*(s1*s1)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0+a*m01*(s1*s1*s1*s1)*s2*(s3*s3*s3*s3)*4.0-(a*a*a)*m01*(s1*s1)*s2*(s3*s3*s3*s3)*1.4E1-(a*a*a)*m01*(s1*s1*s1*s1)*s2*(s3*s3)*2.0-(a*a*a)*k*(s1*s1*s1)*(s2*s2)*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*1.8E1+(a*a*a)*kap*(s1*s1*s1)*(s3*s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0+a*m10*(s1*s1)*s2*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*1.0E1-a*m10*(s1*s1*s1*s1)*s2*(s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0+(a*a*a*a)*k*(s1*s1*s1)*s2*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*1.8E1+(a*a)*kap*(s1*s1*s1)*s2*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0-(a*a*a)*m10*(s1*s1)*s2*(s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0E1-(a*a)*kap*(s1*s1*s1)*s2*(s3*s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0)/((s1*s1)*pow(a*s1*s3,1.0E1/3.0)*9.0-(s2*s2)*pow(a*s1*s3,1.0E1/3.0)*9.0);
        dP_dF.x3131 = 1.0/pow(a*s1*s3,7.0/3.0)*((a*a*a)*m01*s1*s3*2.0+a*m10*s1*s3*pow(a*s1*s3,2.0/3.0)*1.0E1-m10*s1*s2*s3*pow(a*s1*s3,2.0/3.0)*4.0+(a*a)*m01*s1*s2*s3*4.0)*(1.0/3.0);
        dP_dF.x3232 = -((a*a)*m01*(s1*s1*s1*s1)*(s3*s3*s3*s3)*1.4E1+(a*a*a*a)*m01*(s1*s1)*(s3*s3*s3*s3)*2.0-(a*a*a*a)*m01*(s1*s1*s1*s1)*(s3*s3)*4.0-(a*a*a)*kap*(s1*s1*s1)*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0+(a*a)*m10*(s1*s1)*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0E1-(a*a)*m10*(s1*s1*s1*s1)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*1.0E1+(a*a*a*a)*m10*(s1*s1)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0+a*m01*(s1*s1*s1*s1)*s2*(s3*s3*s3*s3)*4.0-(a*a*a)*m01*(s1*s1)*s2*(s3*s3*s3*s3)*2.0-(a*a*a)*m01*(s1*s1*s1*s1)*s2*(s3*s3)*1.4E1-(a*a*a)*k*(s1*s1*s1)*(s2*s2)*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*1.8E1+(a*a*a)*kap*(s1*s1*s1)*(s3*s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0-a*m10*(s1*s1)*s2*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0+a*m10*(s1*s1*s1*s1)*s2*(s3*s3)*pow(a*s1*s3,2.0/3.0)*1.0E1+(a*a*a*a)*k*(s1*s1*s1)*s2*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*1.8E1+(a*a)*kap*(s1*s1*s1)*s2*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0-(a*a*a)*m10*(s1*s1)*s2*(s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0E1-(a*a)*kap*(s1*s1*s1)*s2*(s3*s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0)/((s2*s2)*pow(a*s1*s3,1.0E1/3.0)*9.0-(s3*s3)*pow(a*s1*s3,1.0E1/3.0)*9.0);
        dP_dF.x2112 = -((a*a*a)*m01*(s1*s1*s1)*(s3*s3*s3*s3)*6.0+(a*a*a)*m01*(s1*s1*s1*s1*s1)*(s3*s3)*6.0-a*m01*(s1*s1*s1*s1*s1)*(s3*s3*s3*s3)*1.2E1-(a*a*a)*m01*(s1*s1*s1)*(s2*s2)*(s3*s3)*4.0-(a*a*a*a)*k*(s1*s1*s1*s1)*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*1.8E1+(a*a*a)*m10*(s1*s1*s1)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*1.2E1+(a*a*a*a)*m01*s1*s2*(s3*s3*s3*s3)*4.0+a*m01*(s1*s1*s1)*(s2*s2)*(s3*s3*s3*s3)*8.0-(a*a)*m01*(s1*s1*s1)*s2*(s3*s3*s3*s3)*1.4E1+(a*a*a)*m01*s1*(s2*s2)*(s3*s3*s3*s3)*8.0-(a*a*a*a)*m01*(s1*s1*s1)*s2*(s3*s3)*2.0-a*m10*(s1*s1*s1)*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*6.0-a*m10*(s1*s1*s1*s1*s1)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*6.0-(a*a)*kap*(s1*s1)*(s2*s2)*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0+(a*a)*kap*(s1*s1*s1*s1)*(s3*s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0-a*m10*s1*(s2*s2)*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*4.0+(a*a)*m10*s1*s2*(s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*1.0E1-(a*a*a*a)*m10*s1*s2*(s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0+(a*a*a)*k*(s1*s1*s1*s1)*s2*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*1.8E1+(a*a*a)*kap*(s1*s1)*s2*(s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0+a*m10*(s1*s1*s1)*(s2*s2)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*8.0-(a*a)*m10*(s1*s1*s1)*s2*(s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0E1+(a*a*a)*m10*s1*(s2*s2)*(s3*s3)*pow(a*s1*s3,2.0/3.0)*8.0-(a*a*a)*kap*(s1*s1)*s2*(s3*s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0)/((s1*s1)*pow(a*s1*s3,1.0E1/3.0)*9.0-(s2*s2)*pow(a*s1*s3,1.0E1/3.0)*9.0);
        dP_dF.x3113 = 1.0/pow(a*s1*s3,1.0E1/3.0)*((a*a)*m01*(s1*s1*s1)*(s3*s3*s3)*-1.4E1+(a*a*a*a)*m01*s1*(s3*s3*s3)*4.0+(a*a*a*a)*m01*(s1*s1*s1)*s3*4.0+(a*a*a)*kap*(s1*s1)*(s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0+a*m01*(s1*s1*s1)*s2*(s3*s3*s3)*8.0+(a*a*a)*m01*s1*s2*(s3*s3*s3)*8.0+(a*a*a)*m01*(s1*s1*s1)*s2*s3*8.0-(a*a*a*a)*m10*s1*s3*pow(a*s1*s3,2.0/3.0)*2.0+(a*a)*m10*s1*(s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*1.0E1+(a*a)*m10*(s1*s1*s1)*s3*pow(a*s1*s3,2.0/3.0)*1.0E1-(a*a*a)*kap*(s1*s1)*(s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0-(a*a)*kap*(s1*s1)*s2*(s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0-a*m10*s1*s2*(s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*4.0-a*m10*(s1*s1*s1)*s2*s3*pow(a*s1*s3,2.0/3.0)*4.0+(a*a*a)*m10*s1*s2*s3*pow(a*s1*s3,2.0/3.0)*8.0)*(1.0/9.0);
        dP_dF.x3223 = ((a*a*a)*m01*(s1*s1)*(s3*s3*s3*s3*s3)*6.0+(a*a*a)*m01*(s1*s1*s1*s1)*(s3*s3*s3)*6.0-a*m01*(s1*s1*s1*s1)*(s3*s3*s3*s3*s3)*1.2E1-(a*a*a)*m01*(s1*s1)*(s2*s2)*(s3*s3*s3)*4.0-(a*a*a*a)*k*(s1*s1*s1)*(s3*s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*1.8E1+(a*a*a)*m10*(s1*s1)*(s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*1.2E1+(a*a*a*a)*m01*(s1*s1*s1*s1)*s2*s3*4.0+a*m01*(s1*s1*s1*s1)*(s2*s2)*(s3*s3*s3)*8.0-(a*a)*m01*(s1*s1*s1*s1)*s2*(s3*s3*s3)*1.4E1+(a*a*a)*m01*(s1*s1*s1*s1)*(s2*s2)*s3*8.0-(a*a*a*a)*m01*(s1*s1)*s2*(s3*s3*s3)*2.0-a*m10*(s1*s1)*(s3*s3*s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*6.0-a*m10*(s1*s1*s1*s1)*(s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*6.0-(a*a)*kap*(s1*s1*s1)*(s2*s2)*(s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0+(a*a)*kap*(s1*s1*s1)*(s3*s3*s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0-a*m10*(s1*s1*s1*s1)*(s2*s2)*s3*pow(a*s1*s3,2.0/3.0)*4.0+(a*a)*m10*(s1*s1*s1*s1)*s2*s3*pow(a*s1*s3,2.0/3.0)*1.0E1-(a*a*a*a)*m10*(s1*s1)*s2*s3*pow(a*s1*s3,2.0/3.0)*2.0+(a*a*a)*k*(s1*s1*s1)*s2*(s3*s3*s3*s3)*pow(a*s1*s3,1.0/3.0)*1.8E1+(a*a*a)*kap*(s1*s1*s1)*s2*(s3*s3)*pow(a*s1*s3,1.0/3.0)*9.0+a*m10*(s1*s1)*(s2*s2)*(s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*8.0-(a*a)*m10*(s1*s1)*s2*(s3*s3*s3)*pow(a*s1*s3,2.0/3.0)*2.0E1+(a*a*a)*m10*(s1*s1)*(s2*s2)*s3*pow(a*s1*s3,2.0/3.0)*8.0-(a*a*a)*kap*(s1*s1*s1)*s2*(s3*s3)*log(a*s1*s3)*pow(a*s1*s3,1.0/3.0)*9.0)/((s2*s2)*pow(a*s1*s3,1.0E1/3.0)*9.0-(s3*s3)*pow(a*s1*s3,1.0E1/3.0)*9.0);

    }
    else if ((dx >= 0) && (dy >= 0) && (dz < 0)) // Rz
    {
        dP_dF.x1111 = ((s1*s1)*((a*a*a*a*a)*kap*(s2*s2*s2*s2)*pow(a*s1*s2,1.0/3.0)*-5.4E1+(a*a*a*a*a)*kap*(s2*s2*s2*s2)*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*2.7E1+(a*a*a*a)*kap*(s2*s2*s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*2.7E1)*1.0/pow(a*s1*s2,1.3E1/3.0)*(-1.0/2.7E1))/a+(s1*1.0/pow(a*s1*s2,1.3E1/3.0)*((a*a*a*a*a*a)*m01*(s2*s2*s2*s2*s2)*2.8E1+(a*a*a*a)*m10*(s2*s2*s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*5.0E1-(a*a*a*a*a*a)*m10*(s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*1.0E1+(a*a*a*a*a)*m01*(s2*s2*s2*s2*s2)*s3*5.6E1-(a*a*a)*m10*(s2*s2*s2*s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*2.0E1+(a*a*a*a*a)*m10*(s2*s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*4.0E1)*(1.0/2.7E1))/a-((s1*s1*s1)*1.0/pow(a*s1*s2,1.3E1/3.0)*((a*a*a*a)*m01*(s2*s2*s2*s2*s2)*1.4E1+(a*a*a*a*a*a)*m01*(s2*s2*s2)*2.0-(a*a*a*a)*m10*(s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*2.0E1-(a*a*a)*m01*(s2*s2*s2*s2*s2)*s3*8.0+(a*a*a*a*a)*m01*(s2*s2*s2)*s3*4.0+(a*a*a)*m10*(s2*s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*8.0)*(1.0/2.7E1))/a;
        dP_dF.x2222 = ((s2*s2)*((a*a*a*a*a)*kap*(s1*s1*s1*s1)*pow(a*s1*s2,1.0/3.0)*-5.4E1+(a*a*a*a*a)*kap*(s1*s1*s1*s1)*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*2.7E1+(a*a*a*a)*kap*(s1*s1*s1*s1)*s3*pow(a*s1*s2,1.0/3.0)*2.7E1)*1.0/pow(a*s1*s2,1.3E1/3.0)*(-1.0/2.7E1))/a+(s2*1.0/pow(a*s1*s2,1.3E1/3.0)*((a*a*a*a*a*a)*m01*(s1*s1*s1*s1*s1)*2.8E1+(a*a*a*a)*m10*(s1*s1*s1*s1*s1)*pow(a*s1*s2,2.0/3.0)*5.0E1-(a*a*a*a*a*a)*m10*(s1*s1*s1)*pow(a*s1*s2,2.0/3.0)*1.0E1+(a*a*a*a*a)*m01*(s1*s1*s1*s1*s1)*s3*5.6E1-(a*a*a)*m10*(s1*s1*s1*s1*s1)*s3*pow(a*s1*s2,2.0/3.0)*2.0E1+(a*a*a*a*a)*m10*(s1*s1*s1)*s3*pow(a*s1*s2,2.0/3.0)*4.0E1)*(1.0/2.7E1))/a-((s2*s2*s2)*1.0/pow(a*s1*s2,1.3E1/3.0)*((a*a*a*a)*m01*(s1*s1*s1*s1*s1)*1.4E1+(a*a*a*a*a*a)*m01*(s1*s1*s1)*2.0-(a*a*a*a)*m10*(s1*s1*s1)*pow(a*s1*s2,2.0/3.0)*2.0E1-(a*a*a)*m01*(s1*s1*s1*s1*s1)*s3*8.0+(a*a*a*a*a)*m01*(s1*s1*s1)*s3*4.0+(a*a*a)*m10*(s1*s1*s1)*s3*pow(a*s1*s2,2.0/3.0)*8.0)*(1.0/2.7E1))/a;
        dP_dF.x3333 = k*2.0;
        dP_dF.x2211 = kap/(s1*s2)-((s2*s2*s2*s2)*1.0/pow(a*s1*s2,1.3E1/3.0)*((a*a*a)*m01*(s1*s1*s1*s1*s1)*-2.8E1+(a*a*a*a*a)*m01*(s1*s1*s1)*8.0+(a*a*a)*m10*(s1*s1*s1)*pow(a*s1*s2,2.0/3.0)*4.0E1+(a*a)*m01*(s1*s1*s1*s1*s1)*s3*1.6E1+(a*a*a*a)*m01*(s1*s1*s1)*s3*1.6E1-(a*a)*m10*(s1*s1*s1)*s3*pow(a*s1*s2,2.0/3.0)*1.6E1)*(1.0/2.7E1))/s1-((s2*s2)*1.0/pow(a*s1*s2,1.3E1/3.0)*((a*a*a*a*a)*m01*(s1*s1*s1*s1*s1)*8.0+(a*a*a)*m10*(s1*s1*s1*s1*s1)*pow(a*s1*s2,2.0/3.0)*4.0E1+(a*a*a*a*a)*m10*(s1*s1*s1)*pow(a*s1*s2,2.0/3.0)*4.0+(a*a*a*a)*m01*(s1*s1*s1*s1*s1)*s3*1.6E1-(a*a)*m10*(s1*s1*s1*s1*s1)*s3*pow(a*s1*s2,2.0/3.0)*1.6E1-(a*a*a*a)*m10*(s1*s1*s1)*s3*pow(a*s1*s2,2.0/3.0)*1.6E1)*(1.0/2.7E1))/s1;
        dP_dF.x3311 = kap/(a*s1)-(a*1.0/pow(a*s1*s2,1.0E1/3.0)*(m01*(s1*s1*s1*s1)*(s2*s2*s2*s2)*8.0-m10*(s1*s1)*(s2*s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*4.0+m10*(s1*s1*s1*s1)*(s2*s2)*pow(a*s1*s2,2.0/3.0)*8.0)*(1.0/9.0))/s1-((a*a*a)*1.0/pow(a*s1*s2,1.0E1/3.0)*(m01*(s1*s1)*(s2*s2*s2*s2)*8.0-m01*(s1*s1*s1*s1)*(s2*s2)*4.0+m10*(s1*s1)*(s2*s2)*pow(a*s1*s2,2.0/3.0)*8.0)*(1.0/9.0))/s1;
        dP_dF.x3322 = kap/(a*s2)-(a*1.0/pow(a*s1*s2,1.0E1/3.0)*(m01*(s1*s1*s1*s1)*(s2*s2*s2*s2)*8.0+m10*(s1*s1)*(s2*s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*8.0-m10*(s1*s1*s1*s1)*(s2*s2)*pow(a*s1*s2,2.0/3.0)*4.0)*(1.0/9.0))/s2-((a*a*a)*1.0/pow(a*s1*s2,1.0E1/3.0)*(m01*(s1*s1)*(s2*s2*s2*s2)*-4.0+m01*(s1*s1*s1*s1)*(s2*s2)*8.0+m10*(s1*s1)*(s2*s2)*pow(a*s1*s2,2.0/3.0)*8.0)*(1.0/9.0))/s2;
        dP_dF.x2121 = 1.0/pow(a*s1*s2,7.0/3.0)*((a*a*a)*m01*s1*s2*2.0+a*m10*s1*s2*pow(a*s1*s2,2.0/3.0)*1.0E1-m10*s1*s2*s3*pow(a*s1*s2,2.0/3.0)*4.0+(a*a)*m01*s1*s2*s3*4.0)*(1.0/3.0);
        dP_dF.x3131 = ((a*a)*m01*(s1*s1*s1*s1)*(s2*s2*s2*s2)*1.4E1-(a*a*a*a)*m01*(s1*s1)*(s2*s2*s2*s2)*4.0+(a*a*a*a)*m01*(s1*s1*s1*s1)*(s2*s2)*2.0-(a*a*a)*kap*(s1*s1*s1)*(s2*s2*s2)*pow(a*s1*s2,1.0/3.0)*9.0-(a*a)*m10*(s1*s1)*(s2*s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*1.0E1+(a*a)*m10*(s1*s1*s1*s1)*(s2*s2)*pow(a*s1*s2,2.0/3.0)*2.0E1+(a*a*a*a)*m10*(s1*s1)*(s2*s2)*pow(a*s1*s2,2.0/3.0)*2.0+a*m01*(s1*s1*s1*s1)*(s2*s2*s2*s2)*s3*4.0-(a*a*a)*m01*(s1*s1)*(s2*s2*s2*s2)*s3*1.4E1-(a*a*a)*m01*(s1*s1*s1*s1)*(s2*s2)*s3*2.0-(a*a*a)*k*(s1*s1*s1)*(s2*s2*s2)*(s3*s3)*pow(a*s1*s2,1.0/3.0)*1.8E1+(a*a*a)*kap*(s1*s1*s1)*(s2*s2*s2)*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0+a*m10*(s1*s1)*(s2*s2*s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*1.0E1-a*m10*(s1*s1*s1*s1)*(s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*2.0+(a*a*a*a)*k*(s1*s1*s1)*(s2*s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*1.8E1+(a*a)*kap*(s1*s1*s1)*(s2*s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*9.0-(a*a*a)*m10*(s1*s1)*(s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*2.0E1-(a*a)*kap*(s1*s1*s1)*(s2*s2*s2)*s3*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0)/((s1*s1)*pow(a*s1*s2,1.0E1/3.0)*9.0-(s3*s3)*pow(a*s1*s2,1.0E1/3.0)*9.0);
        dP_dF.x3232 = ((a*a)*m01*(s1*s1*s1*s1)*(s2*s2*s2*s2)*1.4E1+(a*a*a*a)*m01*(s1*s1)*(s2*s2*s2*s2)*2.0-(a*a*a*a)*m01*(s1*s1*s1*s1)*(s2*s2)*4.0-(a*a*a)*kap*(s1*s1*s1)*(s2*s2*s2)*pow(a*s1*s2,1.0/3.0)*9.0+(a*a)*m10*(s1*s1)*(s2*s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*2.0E1-(a*a)*m10*(s1*s1*s1*s1)*(s2*s2)*pow(a*s1*s2,2.0/3.0)*1.0E1+(a*a*a*a)*m10*(s1*s1)*(s2*s2)*pow(a*s1*s2,2.0/3.0)*2.0+a*m01*(s1*s1*s1*s1)*(s2*s2*s2*s2)*s3*4.0-(a*a*a)*m01*(s1*s1)*(s2*s2*s2*s2)*s3*2.0-(a*a*a)*m01*(s1*s1*s1*s1)*(s2*s2)*s3*1.4E1-(a*a*a)*k*(s1*s1*s1)*(s2*s2*s2)*(s3*s3)*pow(a*s1*s2,1.0/3.0)*1.8E1+(a*a*a)*kap*(s1*s1*s1)*(s2*s2*s2)*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0-a*m10*(s1*s1)*(s2*s2*s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*2.0+a*m10*(s1*s1*s1*s1)*(s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*1.0E1+(a*a*a*a)*k*(s1*s1*s1)*(s2*s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*1.8E1+(a*a)*kap*(s1*s1*s1)*(s2*s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*9.0-(a*a*a)*m10*(s1*s1)*(s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*2.0E1-(a*a)*kap*(s1*s1*s1)*(s2*s2*s2)*s3*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0)/((s2*s2)*pow(a*s1*s2,1.0E1/3.0)*9.0-(s3*s3)*pow(a*s1*s2,1.0E1/3.0)*9.0);
        dP_dF.x2112 = 1.0/pow(a*s1*s2,1.0E1/3.0)*((a*a)*m01*(s1*s1*s1)*(s2*s2*s2)*-1.4E1+(a*a*a*a)*m01*s1*(s2*s2*s2)*4.0+(a*a*a*a)*m01*(s1*s1*s1)*s2*4.0+(a*a*a)*kap*(s1*s1)*(s2*s2)*pow(a*s1*s2,1.0/3.0)*9.0+a*m01*(s1*s1*s1)*(s2*s2*s2)*s3*8.0+(a*a*a)*m01*s1*(s2*s2*s2)*s3*8.0+(a*a*a)*m01*(s1*s1*s1)*s2*s3*8.0-(a*a*a*a)*m10*s1*s2*pow(a*s1*s2,2.0/3.0)*2.0+(a*a)*m10*s1*(s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*1.0E1+(a*a)*m10*(s1*s1*s1)*s2*pow(a*s1*s2,2.0/3.0)*1.0E1-(a*a*a)*kap*(s1*s1)*(s2*s2)*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0-(a*a)*kap*(s1*s1)*(s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*9.0-a*m10*s1*(s2*s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*4.0-a*m10*(s1*s1*s1)*s2*s3*pow(a*s1*s2,2.0/3.0)*4.0+(a*a*a)*m10*s1*s2*s3*pow(a*s1*s2,2.0/3.0)*8.0)*(1.0/9.0);
        dP_dF.x3113 = -((a*a*a)*m01*(s1*s1*s1)*(s2*s2*s2*s2)*6.0+(a*a*a)*m01*(s1*s1*s1*s1*s1)*(s2*s2)*6.0-a*m01*(s1*s1*s1*s1*s1)*(s2*s2*s2*s2)*1.2E1-(a*a*a)*m01*(s1*s1*s1)*(s2*s2)*(s3*s3)*4.0-(a*a*a*a)*k*(s1*s1*s1*s1)*(s2*s2*s2)*pow(a*s1*s2,1.0/3.0)*1.8E1+(a*a*a)*m10*(s1*s1*s1)*(s2*s2)*pow(a*s1*s2,2.0/3.0)*1.2E1+(a*a*a*a)*m01*s1*(s2*s2*s2*s2)*s3*4.0+a*m01*(s1*s1*s1)*(s2*s2*s2*s2)*(s3*s3)*8.0-(a*a)*m01*(s1*s1*s1)*(s2*s2*s2*s2)*s3*1.4E1+(a*a*a)*m01*s1*(s2*s2*s2*s2)*(s3*s3)*8.0-(a*a*a*a)*m01*(s1*s1*s1)*(s2*s2)*s3*2.0-a*m10*(s1*s1*s1)*(s2*s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*6.0-a*m10*(s1*s1*s1*s1*s1)*(s2*s2)*pow(a*s1*s2,2.0/3.0)*6.0-(a*a)*kap*(s1*s1)*(s2*s2*s2)*(s3*s3)*pow(a*s1*s2,1.0/3.0)*9.0+(a*a)*kap*(s1*s1*s1*s1)*(s2*s2*s2)*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0-a*m10*s1*(s2*s2*s2*s2)*(s3*s3)*pow(a*s1*s2,2.0/3.0)*4.0+(a*a)*m10*s1*(s2*s2*s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*1.0E1-(a*a*a*a)*m10*s1*(s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*2.0+(a*a*a)*k*(s1*s1*s1*s1)*(s2*s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*1.8E1+(a*a*a)*kap*(s1*s1)*(s2*s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*9.0+a*m10*(s1*s1*s1)*(s2*s2)*(s3*s3)*pow(a*s1*s2,2.0/3.0)*8.0-(a*a)*m10*(s1*s1*s1)*(s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*2.0E1+(a*a*a)*m10*s1*(s2*s2)*(s3*s3)*pow(a*s1*s2,2.0/3.0)*8.0-(a*a*a)*kap*(s1*s1)*(s2*s2*s2)*s3*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0)/((s1*s1)*pow(a*s1*s2,1.0E1/3.0)*9.0-(s3*s3)*pow(a*s1*s2,1.0E1/3.0)*9.0);
        dP_dF.x3223 = -((a*a*a)*m01*(s1*s1)*(s2*s2*s2*s2*s2)*6.0+(a*a*a)*m01*(s1*s1*s1*s1)*(s2*s2*s2)*6.0-a*m01*(s1*s1*s1*s1)*(s2*s2*s2*s2*s2)*1.2E1-(a*a*a)*m01*(s1*s1)*(s2*s2*s2)*(s3*s3)*4.0-(a*a*a*a)*k*(s1*s1*s1)*(s2*s2*s2*s2)*pow(a*s1*s2,1.0/3.0)*1.8E1+(a*a*a)*m10*(s1*s1)*(s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*1.2E1+(a*a*a*a)*m01*(s1*s1*s1*s1)*s2*s3*4.0+a*m01*(s1*s1*s1*s1)*(s2*s2*s2)*(s3*s3)*8.0-(a*a)*m01*(s1*s1*s1*s1)*(s2*s2*s2)*s3*1.4E1+(a*a*a)*m01*(s1*s1*s1*s1)*s2*(s3*s3)*8.0-(a*a*a*a)*m01*(s1*s1)*(s2*s2*s2)*s3*2.0-a*m10*(s1*s1)*(s2*s2*s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*6.0-a*m10*(s1*s1*s1*s1)*(s2*s2*s2)*pow(a*s1*s2,2.0/3.0)*6.0-(a*a)*kap*(s1*s1*s1)*(s2*s2)*(s3*s3)*pow(a*s1*s2,1.0/3.0)*9.0+(a*a)*kap*(s1*s1*s1)*(s2*s2*s2*s2)*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0-a*m10*(s1*s1*s1*s1)*s2*(s3*s3)*pow(a*s1*s2,2.0/3.0)*4.0+(a*a)*m10*(s1*s1*s1*s1)*s2*s3*pow(a*s1*s2,2.0/3.0)*1.0E1-(a*a*a*a)*m10*(s1*s1)*s2*s3*pow(a*s1*s2,2.0/3.0)*2.0+(a*a*a)*k*(s1*s1*s1)*(s2*s2*s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*1.8E1+(a*a*a)*kap*(s1*s1*s1)*(s2*s2)*s3*pow(a*s1*s2,1.0/3.0)*9.0+a*m10*(s1*s1)*(s2*s2*s2)*(s3*s3)*pow(a*s1*s2,2.0/3.0)*8.0-(a*a)*m10*(s1*s1)*(s2*s2*s2)*s3*pow(a*s1*s2,2.0/3.0)*2.0E1+(a*a*a)*m10*(s1*s1)*s2*(s3*s3)*pow(a*s1*s2,2.0/3.0)*8.0-(a*a*a)*kap*(s1*s1*s1)*(s2*s2)*s3*log(a*s1*s2)*pow(a*s1*s2,1.0/3.0)*9.0)/((s2*s2)*pow(a*s1*s2,1.0E1/3.0)*9.0-(s3*s3)*pow(a*s1*s2,1.0E1/3.0)*9.0);

        
    }
    else if ((dx < 0) && (dy < 0) && (dz >= 0)) // Rxy
    {
        dP_dF.x1111 = k*2.0;
        dP_dF.x2222 = k*2.0;
        dP_dF.x3333 = (1.0/(s3*s3*s3)*1.0/pow((a*a)*s3,2.2E1/3.0)*(a*m10*pow((a*a)*s3,2.3E1/3.0)*1.0E2-m10*s1*pow((a*a)*s3,2.3E1/3.0)*2.2E2-m10*s2*pow((a*a)*s3,2.3E1/3.0)*2.2E2+pow(a,1.5E1)*m01*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*2.8E1-pow(a,1.7E1)*m01*(s3*s3*s3*s3*s3*s3*s3)*2.8E1+m10*s1*(s3*s3*s3)*pow((a*a)*s3,2.0E1/3.0)*4.0E1+m10*s2*(s3*s3*s3)*pow((a*a)*s3,2.0E1/3.0)*4.0E1-a*kap*s3*pow((a*a)*s3,2.2E1/3.0)*2.43E2+kap*s1*s3*pow((a*a)*s3,2.2E1/3.0)*8.1E1+kap*s2*s3*pow((a*a)*s3,2.2E1/3.0)*8.1E1+pow(a,1.4E1)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1-pow(a,1.6E1)*m01*s1*(s3*s3*s3*s3*s3*s3*s3)*5.6E1+pow(a,1.4E1)*m01*s2*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1-pow(a,1.6E1)*m01*s2*(s3*s3*s3*s3*s3*s3*s3)*5.6E1-a*m10*(s3*s3*s3)*pow((a*a)*s3,2.0E1/3.0)*1.0E2-pow(a,1.3E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3*s3*s3*s3)*3.2E1-pow(a,1.5E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3*s3)*1.12E2+a*kap*s3*log((a*a)*s3)*pow((a*a)*s3,2.2E1/3.0)*8.1E1+a*m10*s1*s2*s3*pow((a*a)*s3,2.0E1/3.0)*1.6E2-a*m10*s1*s2*(s3*s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*1.6E1)*(-1.0/8.1E1))/a;
        dP_dF.x2211 = 1.0/(a*a)*kap+m10*(s3*s3*s3)*1.0/pow((a*a)*s3,5.0/3.0)*(4.0/9.0)-pow(a,1.0E1)*m01*(s3*s3*s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(1.6E1/9.0)+pow(a,1.2E1)*m01*(s3*s3*s3*s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(4.0/9.0)-(a*a)*m10*s3*1.0/pow((a*a)*s3,5.0/3.0)*(1.6E1/9.0);
        dP_dF.x3311 = (1.0/(s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(m10*pow((a*a)*s3,2.0E1/3.0)*4.4E1-kap*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1-pow(a,1.2E1)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1+pow(a,1.4E1)*m01*(s3*s3*s3*s3*s3*s3)*8.0+m10*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0E1+pow(a,1.1E1)*m01*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*3.2E1+pow(a,1.3E1)*m01*s2*(s3*s3*s3*s3*s3*s3)*1.6E1-a*m10*s2*s3*pow((a*a)*s3,1.7E1/3.0)*3.2E1-a*m10*s2*(s3*s3*s3*s3)*pow((a*a)*s3,1.4E1/3.0)*1.6E1)*(-1.0/2.7E1))/a;
        dP_dF.x3322 = (1.0/(s3*s3)*1.0/pow((a*a)*s3,1.9E1/3.0)*(m10*pow((a*a)*s3,2.0E1/3.0)*4.4E1-kap*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1-pow(a,1.2E1)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1+pow(a,1.4E1)*m01*(s3*s3*s3*s3*s3*s3)*8.0+m10*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0E1+pow(a,1.1E1)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*3.2E1+pow(a,1.3E1)*m01*s1*(s3*s3*s3*s3*s3*s3)*1.6E1-a*m10*s1*s3*pow((a*a)*s3,1.7E1/3.0)*3.2E1-a*m10*s1*(s3*s3*s3*s3)*pow((a*a)*s3,1.4E1/3.0)*1.6E1)*(-1.0/2.7E1))/a;
        dP_dF.x2121 = k*2.0+(k*pow((a*a)*s3,1.9E1/3.0)*-1.8E1+m10*pow((a*a)*s3,1.7E1/3.0)*2.2E1-kap*s3*pow((a*a)*s3,1.6E1/3.0)*9.0+pow(a,1.0E1)*m01*(s3*s3*s3*s3*s3*s3*s3)*1.0E1+pow(a,1.2E1)*m01*(s3*s3*s3*s3*s3)*2.0-m10*(s3*s3*s3)*pow((a*a)*s3,1.4E1/3.0)*1.0E1+kap*s3*log((a*a)*s3)*pow((a*a)*s3,1.6E1/3.0)*9.0)/(a*(s1*s3*pow((a*a)*s3,1.6E1/3.0)*9.0+s2*s3*pow((a*a)*s3,1.6E1/3.0)*9.0));
        dP_dF.x3131 = (pow(a,1.4E1)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*-2.8E1+pow(a,1.6E1)*m01*(s3*s3*s3*s3*s3*s3)*4.0-(a*a)*m10*pow((a*a)*s3,2.0E1/3.0)*2.0E1-m10*(s3*s3)*pow((a*a)*s3,2.0E1/3.0)*1.0E2+a*m10*s1*pow((a*a)*s3,2.0E1/3.0)*1.1E2+a*m10*s2*pow((a*a)*s3,2.0E1/3.0)*4.4E1-m10*s1*s2*pow((a*a)*s3,2.0E1/3.0)*8.0E1+pow(a,1.3E1)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*1.0E1+pow(a,1.5E1)*m01*s1*(s3*s3*s3*s3*s3*s3)*1.4E1-pow(a,1.3E1)*m01*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1+pow(a,1.5E1)*m01*s2*(s3*s3*s3*s3*s3*s3)*8.0-a*kap*s1*s3*pow((a*a)*s3,1.9E1/3.0)*5.4E1-a*kap*s2*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1+kap*s1*s2*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1-pow(a,1.2E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*1.6E1+pow(a,1.4E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3)*2.8E1+a*m10*s1*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*1.0E1+a*m10*s2*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0E1-m10*s1*s2*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0+a*kap*s1*s3*log((a*a)*s3)*pow((a*a)*s3,1.9E1/3.0)*2.7E1)/((s1*s1)*pow((a*a)*s3,2.2E1/3.0)*2.7E1-(s3*s3)*pow((a*a)*s3,2.2E1/3.0)*2.7E1)+(kap*5.4E1+k*(s1*s1)*5.4E1-kap*log((a*a)*s3)*2.7E1-a*k*s1*5.4E1)/((s1*s1)*2.7E1-(s3*s3)*2.7E1);
        dP_dF.x3232 = (pow(a,1.4E1)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*-2.8E1+pow(a,1.6E1)*m01*(s3*s3*s3*s3*s3*s3)*4.0-(a*a)*m10*pow((a*a)*s3,2.0E1/3.0)*2.0E1-m10*(s3*s3)*pow((a*a)*s3,2.0E1/3.0)*1.0E2+a*m10*s1*pow((a*a)*s3,2.0E1/3.0)*4.4E1+a*m10*s2*pow((a*a)*s3,2.0E1/3.0)*1.1E2-m10*s1*s2*pow((a*a)*s3,2.0E1/3.0)*8.0E1-pow(a,1.3E1)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1+pow(a,1.5E1)*m01*s1*(s3*s3*s3*s3*s3*s3)*8.0+pow(a,1.3E1)*m01*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*1.0E1+pow(a,1.5E1)*m01*s2*(s3*s3*s3*s3*s3*s3)*1.4E1-a*kap*s1*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1-a*kap*s2*s3*pow((a*a)*s3,1.9E1/3.0)*5.4E1+kap*s1*s2*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1-pow(a,1.2E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*1.6E1+pow(a,1.4E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3)*2.8E1+a*m10*s1*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0E1+a*m10*s2*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*1.0E1-m10*s1*s2*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0+a*kap*s2*s3*log((a*a)*s3)*pow((a*a)*s3,1.9E1/3.0)*2.7E1)/((s2*s2)*pow((a*a)*s3,2.2E1/3.0)*2.7E1-(s3*s3)*pow((a*a)*s3,2.2E1/3.0)*2.7E1)+(kap*5.4E1+k*(s2*s2)*5.4E1-kap*log((a*a)*s3)*2.7E1-a*k*s2*5.4E1)/((s2*s2)*2.7E1-(s3*s3)*2.7E1);
        dP_dF.x2112 = (1.0/pow((a*a)*s3,1.9E1/3.0)*(a*k*pow((a*a)*s3,1.9E1/3.0)*-1.8E1+a*m10*pow((a*a)*s3,1.7E1/3.0)*2.2E1-m10*s1*pow((a*a)*s3,1.7E1/3.0)*1.6E1-m10*s2*pow((a*a)*s3,1.7E1/3.0)*1.6E1+pow(a,1.1E1)*m01*(s3*s3*s3*s3*s3*s3*s3)*1.0E1+pow(a,1.3E1)*m01*(s3*s3*s3*s3*s3)*2.0+m10*s1*(s3*s3*s3)*pow((a*a)*s3,1.4E1/3.0)*4.0+m10*s2*(s3*s3*s3)*pow((a*a)*s3,1.4E1/3.0)*4.0-a*kap*s3*pow((a*a)*s3,1.6E1/3.0)*9.0+kap*s1*s3*pow((a*a)*s3,1.6E1/3.0)*9.0+kap*s2*s3*pow((a*a)*s3,1.6E1/3.0)*9.0-pow(a,1.0E1)*m01*s1*(s3*s3*s3*s3*s3*s3*s3)*1.6E1+pow(a,1.2E1)*m01*s1*(s3*s3*s3*s3*s3)*4.0-pow(a,1.0E1)*m01*s2*(s3*s3*s3*s3*s3*s3*s3)*1.6E1+pow(a,1.2E1)*m01*s2*(s3*s3*s3*s3*s3)*4.0-a*m10*(s3*s3*s3)*pow((a*a)*s3,1.4E1/3.0)*1.0E1+a*kap*s3*log((a*a)*s3)*pow((a*a)*s3,1.6E1/3.0)*9.0)*(-1.0/9.0))/(s1+s2);
        dP_dF.x3113 = -(pow(a,1.3E1)*m01*pow(s3,1.0E1)*3.0E1+pow(a,1.5E1)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*6.0+kap*s2*(s3*s3*s3)*pow((a*a)*s3,1.9E1/3.0)*2.7E1-m10*(s1*s1)*s2*pow((a*a)*s3,2.0E1/3.0)*3.2E1-m10*s1*(s3*s3)*pow((a*a)*s3,2.0E1/3.0)*1.0E2-m10*s2*(s3*s3)*pow((a*a)*s3,2.0E1/3.0)*4.8E1+m10*s2*(s3*s3*s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*1.2E1-pow(a,1.3E1)*m01*(s1*s1)*(s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1+pow(a,1.5E1)*m01*(s1*s1)*(s3*s3*s3*s3*s3*s3)*8.0-pow(a,1.4E1)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*2.8E1+pow(a,1.6E1)*m01*s1*(s3*s3*s3*s3*s3*s3)*4.0-pow(a,1.2E1)*m01*s2*pow(s3,1.0E1)*4.8E1+pow(a,1.4E1)*m01*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*1.2E1-a*kap*(s3*s3*s3)*pow((a*a)*s3,1.9E1/3.0)*2.7E1+a*m10*(s1*s1)*pow((a*a)*s3,2.0E1/3.0)*4.4E1-(a*a)*m10*s1*pow((a*a)*s3,2.0E1/3.0)*2.0E1+a*m10*(s3*s3)*pow((a*a)*s3,2.0E1/3.0)*6.6E1-a*m10*(s3*s3*s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*3.0E1+a*m10*s1*s2*pow((a*a)*s3,2.0E1/3.0)*4.4E1-pow(a,1.3E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1+pow(a,1.5E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3)*8.0-a*kap*(s1*s1)*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1+pow(a,1.2E1)*m01*(s1*s1)*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*3.2E1+pow(a,1.4E1)*m01*(s1*s1)*s2*(s3*s3*s3*s3*s3*s3)*1.6E1+a*m10*(s1*s1)*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0E1-m10*(s1*s1)*s2*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*1.6E1+a*kap*(s3*s3*s3)*log((a*a)*s3)*pow((a*a)*s3,1.9E1/3.0)*2.7E1-a*kap*s1*s2*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1+a*m10*s1*s2*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0E1)/((s3*s3*s3)*pow((a*a)*s3,2.2E1/3.0)*2.7E1-(s1*s1)*s3*pow((a*a)*s3,2.2E1/3.0)*2.7E1)+(kap*s1*5.4E1+k*s1*(s3*s3)*5.4E1-kap*s1*log((a*a)*s3)*2.7E1-a*k*(s3*s3)*5.4E1)/((s1*s1)*s3*2.7E1-(s3*s3*s3)*2.7E1);
        dP_dF.x3223 = -(pow(a,1.3E1)*m01*pow(s3,1.0E1)*3.0E1+pow(a,1.5E1)*m01*(s3*s3*s3*s3*s3*s3*s3*s3)*6.0+kap*s1*(s3*s3*s3)*pow((a*a)*s3,1.9E1/3.0)*2.7E1-m10*s1*(s2*s2)*pow((a*a)*s3,2.0E1/3.0)*3.2E1-m10*s1*(s3*s3)*pow((a*a)*s3,2.0E1/3.0)*4.8E1+m10*s1*(s3*s3*s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*1.2E1-m10*s2*(s3*s3)*pow((a*a)*s3,2.0E1/3.0)*1.0E2-pow(a,1.3E1)*m01*(s2*s2)*(s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1+pow(a,1.5E1)*m01*(s2*s2)*(s3*s3*s3*s3*s3*s3)*8.0-pow(a,1.2E1)*m01*s1*pow(s3,1.0E1)*4.8E1+pow(a,1.4E1)*m01*s1*(s3*s3*s3*s3*s3*s3*s3*s3)*1.2E1-pow(a,1.4E1)*m01*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*2.8E1+pow(a,1.6E1)*m01*s2*(s3*s3*s3*s3*s3*s3)*4.0-a*kap*(s3*s3*s3)*pow((a*a)*s3,1.9E1/3.0)*2.7E1+a*m10*(s2*s2)*pow((a*a)*s3,2.0E1/3.0)*4.4E1-(a*a)*m10*s2*pow((a*a)*s3,2.0E1/3.0)*2.0E1+a*m10*(s3*s3)*pow((a*a)*s3,2.0E1/3.0)*6.6E1-a*m10*(s3*s3*s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*3.0E1+a*m10*s1*s2*pow((a*a)*s3,2.0E1/3.0)*4.4E1-pow(a,1.3E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3*s3*s3)*2.0E1+pow(a,1.5E1)*m01*s1*s2*(s3*s3*s3*s3*s3*s3)*8.0-a*kap*(s2*s2)*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1+pow(a,1.2E1)*m01*s1*(s2*s2)*(s3*s3*s3*s3*s3*s3*s3*s3)*3.2E1+pow(a,1.4E1)*m01*s1*(s2*s2)*(s3*s3*s3*s3*s3*s3)*1.6E1+a*m10*(s2*s2)*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0E1-m10*s1*(s2*s2)*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*1.6E1+a*kap*(s3*s3*s3)*log((a*a)*s3)*pow((a*a)*s3,1.9E1/3.0)*2.7E1-a*kap*s1*s2*s3*pow((a*a)*s3,1.9E1/3.0)*2.7E1+a*m10*s1*s2*(s3*s3*s3)*pow((a*a)*s3,1.7E1/3.0)*4.0E1)/((s3*s3*s3)*pow((a*a)*s3,2.2E1/3.0)*2.7E1-(s2*s2)*s3*pow((a*a)*s3,2.2E1/3.0)*2.7E1)+(kap*s2*5.4E1+k*s2*(s3*s3)*5.4E1-kap*s2*log((a*a)*s3)*2.7E1-a*k*(s3*s3)*5.4E1)/((s2*s2)*s3*2.7E1-(s3*s3*s3)*2.7E1);

    }
    else if ((dx < 0) && (dy >= 0) && (dz < 0)) // Rzx
    {
        dP_dF.x1111 = k*2.0;
        dP_dF.x2222 = (1.0/(s2*s2*s2)*1.0/pow((a*a)*s2,2.2E1/3.0)*(a*m10*pow((a*a)*s2,2.3E1/3.0)*1.0E2-m10*s1*pow((a*a)*s2,2.3E1/3.0)*2.2E2-m10*s3*pow((a*a)*s2,2.3E1/3.0)*2.2E2+pow(a,1.5E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2*s2)*2.8E1-pow(a,1.7E1)*m01*(s2*s2*s2*s2*s2*s2*s2)*2.8E1+m10*s1*(s2*s2*s2)*pow((a*a)*s2,2.0E1/3.0)*4.0E1+m10*(s2*s2*s2)*s3*pow((a*a)*s2,2.0E1/3.0)*4.0E1-a*kap*s2*pow((a*a)*s2,2.2E1/3.0)*2.43E2+kap*s1*s2*pow((a*a)*s2,2.2E1/3.0)*8.1E1+kap*s2*s3*pow((a*a)*s2,2.2E1/3.0)*8.1E1+pow(a,1.4E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2*s2)*2.0E1-pow(a,1.6E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2)*5.6E1+pow(a,1.4E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2*s2)*s3*2.0E1-pow(a,1.6E1)*m01*(s2*s2*s2*s2*s2*s2*s2)*s3*5.6E1-a*m10*(s2*s2*s2)*pow((a*a)*s2,2.0E1/3.0)*1.0E2-pow(a,1.3E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2*s2)*s3*3.2E1-pow(a,1.5E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2)*s3*1.12E2+a*kap*s2*log((a*a)*s2)*pow((a*a)*s2,2.2E1/3.0)*8.1E1+a*m10*s1*s2*s3*pow((a*a)*s2,2.0E1/3.0)*1.6E2-a*m10*s1*(s2*s2*s2*s2)*s3*pow((a*a)*s2,1.7E1/3.0)*1.6E1)*(-1.0/8.1E1))/a;
        dP_dF.x3333 = k*2.0;
        dP_dF.x2211 = (1.0/(s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(m10*pow((a*a)*s2,2.0E1/3.0)*4.4E1-kap*s2*pow((a*a)*s2,1.9E1/3.0)*2.7E1-pow(a,1.2E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*2.0E1+pow(a,1.4E1)*m01*(s2*s2*s2*s2*s2*s2)*8.0+m10*(s2*s2*s2)*pow((a*a)*s2,1.7E1/3.0)*4.0E1+pow(a,1.1E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*3.2E1+pow(a,1.3E1)*m01*(s2*s2*s2*s2*s2*s2)*s3*1.6E1-a*m10*s2*s3*pow((a*a)*s2,1.7E1/3.0)*3.2E1-a*m10*(s2*s2*s2*s2)*s3*pow((a*a)*s2,1.4E1/3.0)*1.6E1)*(-1.0/2.7E1))/a;
        dP_dF.x3311 = 1.0/(a*a)*kap+m10*(s2*s2*s2)*1.0/pow((a*a)*s2,5.0/3.0)*(4.0/9.0)-pow(a,1.0E1)*m01*(s2*s2*s2*s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(1.6E1/9.0)+pow(a,1.2E1)*m01*(s2*s2*s2*s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(4.0/9.0)-(a*a)*m10*s2*1.0/pow((a*a)*s2,5.0/3.0)*(1.6E1/9.0);
        dP_dF.x3322 = (1.0/(s2*s2)*1.0/pow((a*a)*s2,1.9E1/3.0)*(m10*pow((a*a)*s2,2.0E1/3.0)*4.4E1-kap*s2*pow((a*a)*s2,1.9E1/3.0)*2.7E1-pow(a,1.2E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*2.0E1+pow(a,1.4E1)*m01*(s2*s2*s2*s2*s2*s2)*8.0+m10*(s2*s2*s2)*pow((a*a)*s2,1.7E1/3.0)*4.0E1+pow(a,1.1E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*3.2E1+pow(a,1.3E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*1.6E1-a*m10*s1*s2*pow((a*a)*s2,1.7E1/3.0)*3.2E1-a*m10*s1*(s2*s2*s2*s2)*pow((a*a)*s2,1.4E1/3.0)*1.6E1)*(-1.0/2.7E1))/a;
        dP_dF.x2121 = (pow(a,1.4E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*-2.8E1+pow(a,1.6E1)*m01*(s2*s2*s2*s2*s2*s2)*4.0-(a*a)*m10*pow((a*a)*s2,2.0E1/3.0)*2.0E1-m10*(s2*s2)*pow((a*a)*s2,2.0E1/3.0)*1.0E2+a*m10*s1*pow((a*a)*s2,2.0E1/3.0)*1.1E2+a*m10*s3*pow((a*a)*s2,2.0E1/3.0)*4.4E1-m10*s1*s3*pow((a*a)*s2,2.0E1/3.0)*8.0E1+pow(a,1.3E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*1.0E1+pow(a,1.5E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*1.4E1-pow(a,1.3E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*2.0E1+pow(a,1.5E1)*m01*(s2*s2*s2*s2*s2*s2)*s3*8.0-a*kap*s1*s2*pow((a*a)*s2,1.9E1/3.0)*5.4E1-a*kap*s2*s3*pow((a*a)*s2,1.9E1/3.0)*2.7E1+kap*s1*s2*s3*pow((a*a)*s2,1.9E1/3.0)*2.7E1-pow(a,1.2E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*1.6E1+pow(a,1.4E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*s3*2.8E1+a*m10*s1*(s2*s2*s2)*pow((a*a)*s2,1.7E1/3.0)*1.0E1+a*m10*(s2*s2*s2)*s3*pow((a*a)*s2,1.7E1/3.0)*4.0E1-m10*s1*(s2*s2*s2)*s3*pow((a*a)*s2,1.7E1/3.0)*4.0+a*kap*s1*s2*log((a*a)*s2)*pow((a*a)*s2,1.9E1/3.0)*2.7E1)/((s1*s1)*pow((a*a)*s2,2.2E1/3.0)*2.7E1-(s2*s2)*pow((a*a)*s2,2.2E1/3.0)*2.7E1)+(kap*5.4E1+k*(s1*s1)*5.4E1-kap*log((a*a)*s2)*2.7E1-a*k*s1*5.4E1)/((s1*s1)*2.7E1-(s2*s2)*2.7E1);
        dP_dF.x3131 = k*2.0+(k*pow((a*a)*s2,1.9E1/3.0)*-1.8E1+m10*pow((a*a)*s2,1.7E1/3.0)*2.2E1-kap*s2*pow((a*a)*s2,1.6E1/3.0)*9.0+pow(a,1.0E1)*m01*(s2*s2*s2*s2*s2*s2*s2)*1.0E1+pow(a,1.2E1)*m01*(s2*s2*s2*s2*s2)*2.0-m10*(s2*s2*s2)*pow((a*a)*s2,1.4E1/3.0)*1.0E1+kap*s2*log((a*a)*s2)*pow((a*a)*s2,1.6E1/3.0)*9.0)/(a*(s1*s2*pow((a*a)*s2,1.6E1/3.0)*9.0+s2*s3*pow((a*a)*s2,1.6E1/3.0)*9.0));
        dP_dF.x3232 = -(pow(a,1.4E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*-2.8E1+pow(a,1.6E1)*m01*(s2*s2*s2*s2*s2*s2)*4.0-(a*a)*m10*pow((a*a)*s2,2.0E1/3.0)*2.0E1-m10*(s2*s2)*pow((a*a)*s2,2.0E1/3.0)*1.0E2+a*m10*s1*pow((a*a)*s2,2.0E1/3.0)*4.4E1+a*m10*s3*pow((a*a)*s2,2.0E1/3.0)*1.1E2-m10*s1*s3*pow((a*a)*s2,2.0E1/3.0)*8.0E1-pow(a,1.3E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*2.0E1+pow(a,1.5E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*8.0+pow(a,1.3E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*1.0E1+pow(a,1.5E1)*m01*(s2*s2*s2*s2*s2*s2)*s3*1.4E1-a*kap*s1*s2*pow((a*a)*s2,1.9E1/3.0)*2.7E1-a*kap*s2*s3*pow((a*a)*s2,1.9E1/3.0)*5.4E1+kap*s1*s2*s3*pow((a*a)*s2,1.9E1/3.0)*2.7E1-pow(a,1.2E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*1.6E1+pow(a,1.4E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*s3*2.8E1+a*m10*s1*(s2*s2*s2)*pow((a*a)*s2,1.7E1/3.0)*4.0E1+a*m10*(s2*s2*s2)*s3*pow((a*a)*s2,1.7E1/3.0)*1.0E1-m10*s1*(s2*s2*s2)*s3*pow((a*a)*s2,1.7E1/3.0)*4.0+a*kap*s2*s3*log((a*a)*s2)*pow((a*a)*s2,1.9E1/3.0)*2.7E1)/((s2*s2)*pow((a*a)*s2,2.2E1/3.0)*2.7E1-(s3*s3)*pow((a*a)*s2,2.2E1/3.0)*2.7E1)-(kap*5.4E1+k*(s3*s3)*5.4E1-kap*log((a*a)*s2)*2.7E1-a*k*s3*5.4E1)/((s2*s2)*2.7E1-(s3*s3)*2.7E1);
        dP_dF.x2112 = -(pow(a,1.3E1)*m01*pow(s2,1.0E1)*3.0E1+pow(a,1.5E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*6.0+kap*(s2*s2*s2)*s3*pow((a*a)*s2,1.9E1/3.0)*2.7E1-m10*s1*(s2*s2)*pow((a*a)*s2,2.0E1/3.0)*1.0E2-m10*(s1*s1)*s3*pow((a*a)*s2,2.0E1/3.0)*3.2E1-m10*(s2*s2)*s3*pow((a*a)*s2,2.0E1/3.0)*4.8E1+m10*(s2*s2*s2*s2*s2)*s3*pow((a*a)*s2,1.7E1/3.0)*1.2E1-pow(a,1.3E1)*m01*(s1*s1)*(s2*s2*s2*s2*s2*s2*s2*s2)*2.0E1+pow(a,1.5E1)*m01*(s1*s1)*(s2*s2*s2*s2*s2*s2)*8.0-pow(a,1.4E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*2.8E1+pow(a,1.6E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*4.0-pow(a,1.2E1)*m01*pow(s2,1.0E1)*s3*4.8E1+pow(a,1.4E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*1.2E1-a*kap*(s2*s2*s2)*pow((a*a)*s2,1.9E1/3.0)*2.7E1+a*m10*(s1*s1)*pow((a*a)*s2,2.0E1/3.0)*4.4E1-(a*a)*m10*s1*pow((a*a)*s2,2.0E1/3.0)*2.0E1+a*m10*(s2*s2)*pow((a*a)*s2,2.0E1/3.0)*6.6E1-a*m10*(s2*s2*s2*s2*s2)*pow((a*a)*s2,1.7E1/3.0)*3.0E1+a*m10*s1*s3*pow((a*a)*s2,2.0E1/3.0)*4.4E1-pow(a,1.3E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*2.0E1+pow(a,1.5E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*s3*8.0-a*kap*(s1*s1)*s2*pow((a*a)*s2,1.9E1/3.0)*2.7E1+pow(a,1.2E1)*m01*(s1*s1)*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*3.2E1+pow(a,1.4E1)*m01*(s1*s1)*(s2*s2*s2*s2*s2*s2)*s3*1.6E1+a*m10*(s1*s1)*(s2*s2*s2)*pow((a*a)*s2,1.7E1/3.0)*4.0E1-m10*(s1*s1)*(s2*s2*s2)*s3*pow((a*a)*s2,1.7E1/3.0)*1.6E1+a*kap*(s2*s2*s2)*log((a*a)*s2)*pow((a*a)*s2,1.9E1/3.0)*2.7E1-a*kap*s1*s2*s3*pow((a*a)*s2,1.9E1/3.0)*2.7E1+a*m10*s1*(s2*s2*s2)*s3*pow((a*a)*s2,1.7E1/3.0)*4.0E1)/((s2*s2*s2)*pow((a*a)*s2,2.2E1/3.0)*2.7E1-(s1*s1)*s2*pow((a*a)*s2,2.2E1/3.0)*2.7E1)+(kap*s1*5.4E1+k*s1*(s2*s2)*5.4E1-kap*s1*log((a*a)*s2)*2.7E1-a*k*(s2*s2)*5.4E1)/((s1*s1)*s2*2.7E1-(s2*s2*s2)*2.7E1);
        dP_dF.x3113 = (1.0/pow((a*a)*s2,1.9E1/3.0)*(a*k*pow((a*a)*s2,1.9E1/3.0)*-1.8E1+a*m10*pow((a*a)*s2,1.7E1/3.0)*2.2E1-m10*s1*pow((a*a)*s2,1.7E1/3.0)*1.6E1-m10*s3*pow((a*a)*s2,1.7E1/3.0)*1.6E1+pow(a,1.1E1)*m01*(s2*s2*s2*s2*s2*s2*s2)*1.0E1+pow(a,1.3E1)*m01*(s2*s2*s2*s2*s2)*2.0+m10*s1*(s2*s2*s2)*pow((a*a)*s2,1.4E1/3.0)*4.0+m10*(s2*s2*s2)*s3*pow((a*a)*s2,1.4E1/3.0)*4.0-a*kap*s2*pow((a*a)*s2,1.6E1/3.0)*9.0+kap*s1*s2*pow((a*a)*s2,1.6E1/3.0)*9.0+kap*s2*s3*pow((a*a)*s2,1.6E1/3.0)*9.0-pow(a,1.0E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2)*1.6E1+pow(a,1.2E1)*m01*s1*(s2*s2*s2*s2*s2)*4.0-pow(a,1.0E1)*m01*(s2*s2*s2*s2*s2*s2*s2)*s3*1.6E1+pow(a,1.2E1)*m01*(s2*s2*s2*s2*s2)*s3*4.0-a*m10*(s2*s2*s2)*pow((a*a)*s2,1.4E1/3.0)*1.0E1+a*kap*s2*log((a*a)*s2)*pow((a*a)*s2,1.6E1/3.0)*9.0)*(-1.0/9.0))/(s1+s3);
        dP_dF.x3223 = -(pow(a,1.3E1)*m01*pow(s2,1.0E1)*3.0E1+pow(a,1.5E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*6.0+kap*s1*(s2*s2*s2)*pow((a*a)*s2,1.9E1/3.0)*2.7E1-m10*s1*(s2*s2)*pow((a*a)*s2,2.0E1/3.0)*4.8E1+m10*s1*(s2*s2*s2*s2*s2)*pow((a*a)*s2,1.7E1/3.0)*1.2E1-m10*s1*(s3*s3)*pow((a*a)*s2,2.0E1/3.0)*3.2E1-m10*(s2*s2)*s3*pow((a*a)*s2,2.0E1/3.0)*1.0E2-pow(a,1.3E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*(s3*s3)*2.0E1+pow(a,1.5E1)*m01*(s2*s2*s2*s2*s2*s2)*(s3*s3)*8.0-pow(a,1.2E1)*m01*s1*pow(s2,1.0E1)*4.8E1+pow(a,1.4E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*1.2E1-pow(a,1.4E1)*m01*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*2.8E1+pow(a,1.6E1)*m01*(s2*s2*s2*s2*s2*s2)*s3*4.0-a*kap*(s2*s2*s2)*pow((a*a)*s2,1.9E1/3.0)*2.7E1+a*m10*(s2*s2)*pow((a*a)*s2,2.0E1/3.0)*6.6E1-a*m10*(s2*s2*s2*s2*s2)*pow((a*a)*s2,1.7E1/3.0)*3.0E1+a*m10*(s3*s3)*pow((a*a)*s2,2.0E1/3.0)*4.4E1-(a*a)*m10*s3*pow((a*a)*s2,2.0E1/3.0)*2.0E1+a*m10*s1*s3*pow((a*a)*s2,2.0E1/3.0)*4.4E1-pow(a,1.3E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*s3*2.0E1+pow(a,1.5E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*s3*8.0-a*kap*s2*(s3*s3)*pow((a*a)*s2,1.9E1/3.0)*2.7E1+pow(a,1.2E1)*m01*s1*(s2*s2*s2*s2*s2*s2*s2*s2)*(s3*s3)*3.2E1+pow(a,1.4E1)*m01*s1*(s2*s2*s2*s2*s2*s2)*(s3*s3)*1.6E1+a*m10*(s2*s2*s2)*(s3*s3)*pow((a*a)*s2,1.7E1/3.0)*4.0E1-m10*s1*(s2*s2*s2)*(s3*s3)*pow((a*a)*s2,1.7E1/3.0)*1.6E1+a*kap*(s2*s2*s2)*log((a*a)*s2)*pow((a*a)*s2,1.9E1/3.0)*2.7E1-a*kap*s1*s2*s3*pow((a*a)*s2,1.9E1/3.0)*2.7E1+a*m10*s1*(s2*s2*s2)*s3*pow((a*a)*s2,1.7E1/3.0)*4.0E1)/((s2*s2*s2)*pow((a*a)*s2,2.2E1/3.0)*2.7E1-s2*(s3*s3)*pow((a*a)*s2,2.2E1/3.0)*2.7E1)+(kap*s3*5.4E1+k*(s2*s2)*s3*5.4E1-kap*s3*log((a*a)*s2)*2.7E1-a*k*(s2*s2)*5.4E1)/(s2*(s3*s3)*2.7E1-(s2*s2*s2)*2.7E1);

    }
    else if ((dx >= 0) && (dy < 0) && (dz < 0)) // Ryz
    {
        dP_dF.x1111 = (1.0/(s1*s1)*1.0/pow((a*a)*s1,3.1E1/3.0)*(a*kap*pow((a*a)*s1,3.1E1/3.0)*2.43E2-kap*s2*pow((a*a)*s1,3.1E1/3.0)*8.1E1-kap*s3*pow((a*a)*s1,3.1E1/3.0)*8.1E1-pow(a,2.1E1)*m01*pow(s1,1.1E1)*2.8E1+pow(a,2.3E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*2.8E1-(a*a*a)*m10*pow((a*a)*s1,2.9E1/3.0)*1.0E2-m10*(s1*s1)*s2*pow((a*a)*s1,2.9E1/3.0)*4.0E1-m10*(s1*s1)*s3*pow((a*a)*s1,2.9E1/3.0)*4.0E1-a*kap*log((a*a)*s1)*pow((a*a)*s1,3.1E1/3.0)*8.1E1-pow(a,2.0E1)*m01*pow(s1,1.1E1)*s2*2.0E1+pow(a,2.2E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s2*5.6E1-pow(a,2.0E1)*m01*pow(s1,1.1E1)*s3*2.0E1+pow(a,2.2E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s3*5.6E1+a*m10*(s1*s1)*pow((a*a)*s1,2.9E1/3.0)*1.0E2+(a*a)*m10*s2*pow((a*a)*s1,2.9E1/3.0)*2.2E2+(a*a)*m10*s3*pow((a*a)*s1,2.9E1/3.0)*2.2E2-a*m10*s2*s3*pow((a*a)*s1,2.9E1/3.0)*1.6E2+pow(a,1.9E1)*m01*pow(s1,1.1E1)*s2*s3*3.2E1+pow(a,2.1E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s2*s3*1.12E2+a*m10*(s1*s1*s1)*s2*s3*pow((a*a)*s1,2.6E1/3.0)*1.6E1)*(1.0/8.1E1))/a;
        dP_dF.x2222 = k*2.0;
        dP_dF.x3333 = k*2.0;
        dP_dF.x2211 = (1.0/pow((a*a)*s1,2.8E1/3.0)*(kap*pow((a*a)*s1,2.8E1/3.0)*-2.7E1-pow(a,1.8E1)*m01*pow(s1,1.0E1)*2.0E1+pow(a,2.0E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*8.0+(a*a)*m10*pow((a*a)*s1,2.6E1/3.0)*4.4E1+m10*(s1*s1)*pow((a*a)*s1,2.6E1/3.0)*4.0E1-a*m10*s3*pow((a*a)*s1,2.6E1/3.0)*3.2E1+pow(a,1.7E1)*m01*pow(s1,1.0E1)*s3*3.2E1+pow(a,1.9E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s3*1.6E1-a*m10*(s1*s1*s1)*s3*pow((a*a)*s1,2.3E1/3.0)*1.6E1)*(-1.0/2.7E1))/(a*s1);
        dP_dF.x3311 = (1.0/pow((a*a)*s1,2.8E1/3.0)*(kap*pow((a*a)*s1,2.8E1/3.0)*-2.7E1-pow(a,1.8E1)*m01*pow(s1,1.0E1)*2.0E1+pow(a,2.0E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*8.0+(a*a)*m10*pow((a*a)*s1,2.6E1/3.0)*4.4E1+m10*(s1*s1)*pow((a*a)*s1,2.6E1/3.0)*4.0E1-a*m10*s2*pow((a*a)*s1,2.6E1/3.0)*3.2E1+pow(a,1.7E1)*m01*pow(s1,1.0E1)*s2*3.2E1+pow(a,1.9E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s2*1.6E1-a*m10*(s1*s1*s1)*s2*pow((a*a)*s1,2.3E1/3.0)*1.6E1)*(-1.0/2.7E1))/(a*s1);
        dP_dF.x3322 = 1.0/(a*a)*kap+m10*(s1*s1*s1)*1.0/pow((a*a)*s1,5.0/3.0)*(4.0/9.0)-pow(a,1.6E1)*m01*pow(s1,1.0E1)*1.0/pow((a*a)*s1,2.8E1/3.0)*(1.6E1/9.0)+pow(a,1.8E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*1.0/pow((a*a)*s1,2.8E1/3.0)*(4.0/9.0)-(a*a)*m10*s1*1.0/pow((a*a)*s1,5.0/3.0)*(1.6E1/9.0);
        dP_dF.x2121 = -(kap*pow((a*a)*s1,3.1E1/3.0)*5.4E1-pow(a,2.0E1)*m01*pow(s1,1.1E1)*2.8E1+pow(a,2.2E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*4.0-(a*a)*m10*pow((a*a)*s1,2.9E1/3.0)*2.0E1+k*(s2*s2)*pow((a*a)*s1,3.1E1/3.0)*5.4E1-m10*(s1*s1)*pow((a*a)*s1,2.9E1/3.0)*1.0E2-kap*log((a*a)*s1)*pow((a*a)*s1,3.1E1/3.0)*2.7E1-a*k*s2*pow((a*a)*s1,3.1E1/3.0)*5.4E1+a*m10*s2*pow((a*a)*s1,2.9E1/3.0)*1.1E2+a*m10*s3*pow((a*a)*s1,2.9E1/3.0)*4.4E1-m10*s2*s3*pow((a*a)*s1,2.9E1/3.0)*8.0E1+pow(a,1.9E1)*m01*pow(s1,1.1E1)*s2*1.0E1+pow(a,2.1E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s2*1.4E1-pow(a,1.9E1)*m01*pow(s1,1.1E1)*s3*2.0E1+pow(a,2.1E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s3*8.0-a*kap*s1*s2*pow((a*a)*s1,2.8E1/3.0)*5.4E1-a*kap*s1*s3*pow((a*a)*s1,2.8E1/3.0)*2.7E1+kap*s1*s2*s3*pow((a*a)*s1,2.8E1/3.0)*2.7E1-pow(a,1.8E1)*m01*pow(s1,1.1E1)*s2*s3*1.6E1+pow(a,2.0E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s2*s3*2.8E1+a*m10*(s1*s1*s1)*s2*pow((a*a)*s1,2.6E1/3.0)*1.0E1+a*m10*(s1*s1*s1)*s3*pow((a*a)*s1,2.6E1/3.0)*4.0E1-m10*(s1*s1*s1)*s2*s3*pow((a*a)*s1,2.6E1/3.0)*4.0+a*kap*s1*s2*log((a*a)*s1)*pow((a*a)*s1,2.8E1/3.0)*2.7E1)/((s1*s1)*pow((a*a)*s1,3.1E1/3.0)*2.7E1-(s2*s2)*pow((a*a)*s1,3.1E1/3.0)*2.7E1);
        dP_dF.x3131 = -(kap*pow((a*a)*s1,3.1E1/3.0)*5.4E1-pow(a,2.0E1)*m01*pow(s1,1.1E1)*2.8E1+pow(a,2.2E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*4.0-(a*a)*m10*pow((a*a)*s1,2.9E1/3.0)*2.0E1+k*(s3*s3)*pow((a*a)*s1,3.1E1/3.0)*5.4E1-m10*(s1*s1)*pow((a*a)*s1,2.9E1/3.0)*1.0E2-kap*log((a*a)*s1)*pow((a*a)*s1,3.1E1/3.0)*2.7E1-a*k*s3*pow((a*a)*s1,3.1E1/3.0)*5.4E1+a*m10*s2*pow((a*a)*s1,2.9E1/3.0)*4.4E1+a*m10*s3*pow((a*a)*s1,2.9E1/3.0)*1.1E2-m10*s2*s3*pow((a*a)*s1,2.9E1/3.0)*8.0E1-pow(a,1.9E1)*m01*pow(s1,1.1E1)*s2*2.0E1+pow(a,2.1E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s2*8.0+pow(a,1.9E1)*m01*pow(s1,1.1E1)*s3*1.0E1+pow(a,2.1E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s3*1.4E1-a*kap*s1*s2*pow((a*a)*s1,2.8E1/3.0)*2.7E1-a*kap*s1*s3*pow((a*a)*s1,2.8E1/3.0)*5.4E1+kap*s1*s2*s3*pow((a*a)*s1,2.8E1/3.0)*2.7E1-pow(a,1.8E1)*m01*pow(s1,1.1E1)*s2*s3*1.6E1+pow(a,2.0E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s2*s3*2.8E1+a*m10*(s1*s1*s1)*s2*pow((a*a)*s1,2.6E1/3.0)*4.0E1+a*m10*(s1*s1*s1)*s3*pow((a*a)*s1,2.6E1/3.0)*1.0E1-m10*(s1*s1*s1)*s2*s3*pow((a*a)*s1,2.6E1/3.0)*4.0+a*kap*s1*s3*log((a*a)*s1)*pow((a*a)*s1,2.8E1/3.0)*2.7E1)/((s1*s1)*pow((a*a)*s1,3.1E1/3.0)*2.7E1-(s3*s3)*pow((a*a)*s1,3.1E1/3.0)*2.7E1);
        dP_dF.x3232 = k*2.0+(kap*pow((a*a)*s1,2.5E1/3.0)*-9.0+pow(a,1.6E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*1.0E1+pow(a,1.8E1)*m01*(s1*s1*s1*s1*s1*s1*s1)*2.0-(a*a)*k*pow((a*a)*s1,2.5E1/3.0)*1.8E1+(a*a)*m10*pow((a*a)*s1,2.3E1/3.0)*2.2E1-m10*(s1*s1)*pow((a*a)*s1,2.3E1/3.0)*1.0E1+kap*log((a*a)*s1)*pow((a*a)*s1,2.5E1/3.0)*9.0)/(a*(s2*pow((a*a)*s1,2.5E1/3.0)*9.0+s3*pow((a*a)*s1,2.5E1/3.0)*9.0));
        dP_dF.x2112 = (1.0/pow((a*a)*s1,3.1E1/3.0)*(pow(a,1.9E1)*m01*pow(s1,1.2E1)*3.0E1+pow(a,2.1E1)*m01*pow(s1,1.0E1)*6.0+kap*(s1*s1)*s3*pow((a*a)*s1,2.8E1/3.0)*2.7E1+m10*(s1*s1*s1*s1)*s3*pow((a*a)*s1,2.6E1/3.0)*1.2E1-pow(a,1.9E1)*m01*pow(s1,1.0E1)*(s2*s2)*2.0E1+pow(a,2.1E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*(s2*s2)*8.0+(a*a*a)*m10*(s2*s2)*pow((a*a)*s1,2.6E1/3.0)*4.4E1-a*k*s1*pow((a*a)*s1,3.1E1/3.0)*5.4E1+a*m10*s1*pow((a*a)*s1,2.9E1/3.0)*6.6E1+k*s1*s2*pow((a*a)*s1,3.1E1/3.0)*5.4E1-m10*s1*s2*pow((a*a)*s1,2.9E1/3.0)*1.0E2-m10*s1*s3*pow((a*a)*s1,2.9E1/3.0)*4.8E1-pow(a,2.0E1)*m01*pow(s1,1.0E1)*s2*2.8E1+pow(a,2.2E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s2*4.0-pow(a,1.8E1)*m01*pow(s1,1.2E1)*s3*4.8E1+pow(a,2.0E1)*m01*pow(s1,1.0E1)*s3*1.2E1-a*kap*(s1*s1)*pow((a*a)*s1,2.8E1/3.0)*2.7E1-a*kap*(s2*s2)*pow((a*a)*s1,2.8E1/3.0)*2.7E1+(a*a)*kap*s2*pow((a*a)*s1,2.8E1/3.0)*5.4E1-a*m10*(s1*s1*s1*s1)*pow((a*a)*s1,2.6E1/3.0)*3.0E1-(a*a*a*a)*m10*s2*pow((a*a)*s1,2.6E1/3.0)*2.0E1-a*kap*s2*s3*pow((a*a)*s1,2.8E1/3.0)*2.7E1-pow(a,1.9E1)*m01*pow(s1,1.0E1)*s2*s3*2.0E1+pow(a,2.1E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s2*s3*8.0+(a*a*a)*m10*s2*s3*pow((a*a)*s1,2.6E1/3.0)*4.4E1+pow(a,1.8E1)*m01*pow(s1,1.0E1)*(s2*s2)*s3*3.2E1+pow(a,2.0E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*(s2*s2)*s3*1.6E1+a*m10*(s1*s1)*(s2*s2)*pow((a*a)*s1,2.6E1/3.0)*4.0E1-(a*a)*m10*(s2*s2)*s3*pow((a*a)*s1,2.6E1/3.0)*3.2E1-m10*(s1*s1)*(s2*s2)*s3*pow((a*a)*s1,2.6E1/3.0)*1.6E1+a*kap*(s1*s1)*log((a*a)*s1)*pow((a*a)*s1,2.8E1/3.0)*2.7E1-(a*a)*kap*s2*log((a*a)*s1)*pow((a*a)*s1,2.8E1/3.0)*2.7E1+a*m10*(s1*s1)*s2*s3*pow((a*a)*s1,2.6E1/3.0)*4.0E1)*(-1.0/2.7E1))/(s1*s1-s2*s2);
        dP_dF.x3113 = (1.0/pow((a*a)*s1,3.1E1/3.0)*(pow(a,1.9E1)*m01*pow(s1,1.2E1)*3.0E1+pow(a,2.1E1)*m01*pow(s1,1.0E1)*6.0+kap*(s1*s1)*s2*pow((a*a)*s1,2.8E1/3.0)*2.7E1+m10*(s1*s1*s1*s1)*s2*pow((a*a)*s1,2.6E1/3.0)*1.2E1-pow(a,1.9E1)*m01*pow(s1,1.0E1)*(s3*s3)*2.0E1+pow(a,2.1E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*(s3*s3)*8.0+(a*a*a)*m10*(s3*s3)*pow((a*a)*s1,2.6E1/3.0)*4.4E1-a*k*s1*pow((a*a)*s1,3.1E1/3.0)*5.4E1+a*m10*s1*pow((a*a)*s1,2.9E1/3.0)*6.6E1+k*s1*s3*pow((a*a)*s1,3.1E1/3.0)*5.4E1-m10*s1*s2*pow((a*a)*s1,2.9E1/3.0)*4.8E1-m10*s1*s3*pow((a*a)*s1,2.9E1/3.0)*1.0E2-pow(a,1.8E1)*m01*pow(s1,1.2E1)*s2*4.8E1+pow(a,2.0E1)*m01*pow(s1,1.0E1)*s2*1.2E1-pow(a,2.0E1)*m01*pow(s1,1.0E1)*s3*2.8E1+pow(a,2.2E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s3*4.0-a*kap*(s1*s1)*pow((a*a)*s1,2.8E1/3.0)*2.7E1-a*kap*(s3*s3)*pow((a*a)*s1,2.8E1/3.0)*2.7E1+(a*a)*kap*s3*pow((a*a)*s1,2.8E1/3.0)*5.4E1-a*m10*(s1*s1*s1*s1)*pow((a*a)*s1,2.6E1/3.0)*3.0E1-(a*a*a*a)*m10*s3*pow((a*a)*s1,2.6E1/3.0)*2.0E1-a*kap*s2*s3*pow((a*a)*s1,2.8E1/3.0)*2.7E1-pow(a,1.9E1)*m01*pow(s1,1.0E1)*s2*s3*2.0E1+pow(a,2.1E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s2*s3*8.0+(a*a*a)*m10*s2*s3*pow((a*a)*s1,2.6E1/3.0)*4.4E1+pow(a,1.8E1)*m01*pow(s1,1.0E1)*s2*(s3*s3)*3.2E1+pow(a,2.0E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1)*s2*(s3*s3)*1.6E1+a*m10*(s1*s1)*(s3*s3)*pow((a*a)*s1,2.6E1/3.0)*4.0E1-(a*a)*m10*s2*(s3*s3)*pow((a*a)*s1,2.6E1/3.0)*3.2E1-m10*(s1*s1)*s2*(s3*s3)*pow((a*a)*s1,2.6E1/3.0)*1.6E1+a*kap*(s1*s1)*log((a*a)*s1)*pow((a*a)*s1,2.8E1/3.0)*2.7E1-(a*a)*kap*s3*log((a*a)*s1)*pow((a*a)*s1,2.8E1/3.0)*2.7E1+a*m10*(s1*s1)*s2*s3*pow((a*a)*s1,2.6E1/3.0)*4.0E1)*(-1.0/2.7E1))/(s1*s1-s3*s3);
        dP_dF.x3223 = -(1.0/(a*a)*(pow(a,1.7E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*1.0E1+pow(a,1.9E1)*m01*(s1*s1*s1*s1*s1*s1*s1)*2.0+(a*a*a)*m10*pow((a*a)*s1,2.3E1/3.0)*2.2E1+m10*(s1*s1)*s2*pow((a*a)*s1,2.3E1/3.0)*4.0+m10*(s1*s1)*s3*pow((a*a)*s1,2.3E1/3.0)*4.0-pow(a,1.6E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s2*1.6E1+pow(a,1.8E1)*m01*(s1*s1*s1*s1*s1*s1*s1)*s2*4.0-pow(a,1.6E1)*m01*(s1*s1*s1*s1*s1*s1*s1*s1*s1)*s3*1.6E1+pow(a,1.8E1)*m01*(s1*s1*s1*s1*s1*s1*s1)*s3*4.0-a*m10*(s1*s1)*pow((a*a)*s1,2.3E1/3.0)*1.0E1-(a*a)*m10*s2*pow((a*a)*s1,2.3E1/3.0)*1.6E1-(a*a)*m10*s3*pow((a*a)*s1,2.3E1/3.0)*1.6E1))/(s2*pow((a*a)*s1,2.5E1/3.0)*9.0+s3*pow((a*a)*s1,2.5E1/3.0)*9.0)-(1.0/(a*a)*(a*kap*-9.0+kap*s2*9.0+kap*s3*9.0-(a*a*a)*k*1.8E1+a*kap*log((a*a)*s1)*9.0))/(s2*9.0+s3*9.0);

    }
    else // Rxyz
    {
        dP_dF.x1111 = k*2.0;
        dP_dF.x2222 = k*2.0;
        dP_dF.x3333 = k*2.0;
        dP_dF.x2211 = 1.0/(a*a)*((kap*pow(a*a*a,2.0/3.0)*9.0-m01*s3*pow(a*a*a,1.0/3.0)*1.6E1)*1.0/pow(a*a*a,2.0/3.0)*(1.0/9.0)+a*(m10*s3*1.6E1+m01*pow(a*a*a,1.0/3.0)*4.0)*1.0/pow(a*a*a,2.0/3.0)*(1.0/9.0))-m10*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0);
        dP_dF.x3311 = 1.0/(a*a)*((kap*pow(a*a*a,2.0/3.0)*9.0-m01*s2*pow(a*a*a,1.0/3.0)*1.6E1)*1.0/pow(a*a*a,2.0/3.0)*(1.0/9.0)+a*(m10*s2*1.6E1+m01*pow(a*a*a,1.0/3.0)*4.0)*1.0/pow(a*a*a,2.0/3.0)*(1.0/9.0))-m10*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0);
        dP_dF.x3322 = 1.0/(a*a)*((kap*pow(a*a*a,2.0/3.0)*9.0-m01*s1*pow(a*a*a,1.0/3.0)*1.6E1)*1.0/pow(a*a*a,2.0/3.0)*(1.0/9.0)+a*(m10*s1*1.6E1+m01*pow(a*a*a,1.0/3.0)*4.0)*1.0/pow(a*a*a,2.0/3.0)*(1.0/9.0))-m10*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0);
        dP_dF.x2121 = (kap*s3+a*(kap*-2.0+kap*log(a*a*a)+m01*s3*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0)))/((a*a)*s1+(a*a)*s2)+(k*s1*2.0+k*s2*2.0+m01*1.0/pow(a*a*a,1.0/3.0)*(8.0/9.0)-m10*s3*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0))/(s1+s2)-(a*(k*2.0-m10*1.0/pow(a*a*a,2.0/3.0)*(4.0E1/9.0)))/(s1+s2);
        dP_dF.x3131 = (kap*s2+a*(kap*-2.0+kap*log(a*a*a)+m01*s2*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0)))/((a*a)*s1+(a*a)*s3)+(k*s1*2.0+k*s3*2.0+m01*1.0/pow(a*a*a,1.0/3.0)*(8.0/9.0)-m10*s2*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0))/(s1+s3)-(a*(k*2.0-m10*1.0/pow(a*a*a,2.0/3.0)*(4.0E1/9.0)))/(s1+s3);
        dP_dF.x3232 = (kap*s1+a*(kap*-2.0+kap*log(a*a*a)+m01*s1*1.0/pow(a*a*a,1.0/3.0)*(4.0/9.0)))/((a*a)*s2+(a*a)*s3)+(k*s2*2.0+k*s3*2.0+m01*1.0/pow(a*a*a,1.0/3.0)*(8.0/9.0)-m10*s1*1.0/pow(a*a*a,2.0/3.0)*(2.8E1/9.0))/(s2+s3)-(a*(k*2.0-m10*1.0/pow(a*a*a,2.0/3.0)*(4.0E1/9.0)))/(s2+s3);
        dP_dF.x2112 = -((a*a*a*a*a)*k*-1.8E1-(a*a*a)*kap*1.8E1+(a*a*a)*kap*log(a*a*a)*9.0+(a*a)*kap*s1*9.0+(a*a)*kap*s2*9.0+(a*a)*kap*s3*9.0)/((a*a*a*a)*s1*9.0+(a*a*a*a)*s2*9.0)-((a*a*a*a*a)*m10*4.0E1-(a*a*a*a)*m10*s1*2.8E1-(a*a*a*a)*m10*s2*2.8E1-(a*a*a*a)*m10*s3*2.8E1+(a*a*a*a)*m01*pow(a*a*a,1.0/3.0)*8.0+(a*a*a)*m01*s1*pow(a*a*a,1.0/3.0)*4.0+(a*a*a)*m01*s2*pow(a*a*a,1.0/3.0)*4.0+(a*a*a)*m01*s3*pow(a*a*a,1.0/3.0)*4.0+(a*a*a)*m10*s1*s3*1.6E1+(a*a*a)*m10*s2*s3*1.6E1-(a*a)*m01*s1*s3*pow(a*a*a,1.0/3.0)*1.6E1-(a*a)*m01*s2*s3*pow(a*a*a,1.0/3.0)*1.6E1)/((a*a*a*a)*s1*pow(a*a*a,2.0/3.0)*9.0+(a*a*a*a)*s2*pow(a*a*a,2.0/3.0)*9.0);
        dP_dF.x3113 = -((a*a*a*a*a)*k*-1.8E1-(a*a*a)*kap*1.8E1+(a*a*a)*kap*log(a*a*a)*9.0+(a*a)*kap*s1*9.0+(a*a)*kap*s2*9.0+(a*a)*kap*s3*9.0)/((a*a*a*a)*s1*9.0+(a*a*a*a)*s3*9.0)-((a*a*a*a*a)*m10*4.0E1-(a*a*a*a)*m10*s1*2.8E1-(a*a*a*a)*m10*s2*2.8E1-(a*a*a*a)*m10*s3*2.8E1+(a*a*a*a)*m01*pow(a*a*a,1.0/3.0)*8.0+(a*a*a)*m01*s1*pow(a*a*a,1.0/3.0)*4.0+(a*a*a)*m01*s2*pow(a*a*a,1.0/3.0)*4.0+(a*a*a)*m01*s3*pow(a*a*a,1.0/3.0)*4.0+(a*a*a)*m10*s1*s2*1.6E1+(a*a*a)*m10*s2*s3*1.6E1-(a*a)*m01*s1*s2*pow(a*a*a,1.0/3.0)*1.6E1-(a*a)*m01*s2*s3*pow(a*a*a,1.0/3.0)*1.6E1)/((a*a*a*a)*s1*pow(a*a*a,2.0/3.0)*9.0+(a*a*a*a)*s3*pow(a*a*a,2.0/3.0)*9.0);
        dP_dF.x3223 = -((a*a*a*a*a)*k*-1.8E1-(a*a*a)*kap*1.8E1+(a*a*a)*kap*log(a*a*a)*9.0+(a*a)*kap*s1*9.0+(a*a)*kap*s2*9.0+(a*a)*kap*s3*9.0)/((a*a*a*a)*s2*9.0+(a*a*a*a)*s3*9.0)-((a*a*a*a*a)*m10*4.0E1-(a*a*a*a)*m10*s1*2.8E1-(a*a*a*a)*m10*s2*2.8E1-(a*a*a*a)*m10*s3*2.8E1+(a*a*a*a)*m01*pow(a*a*a,1.0/3.0)*8.0+(a*a*a)*m01*s1*pow(a*a*a,1.0/3.0)*4.0+(a*a*a)*m01*s2*pow(a*a*a,1.0/3.0)*4.0+(a*a*a)*m01*s3*pow(a*a*a,1.0/3.0)*4.0+(a*a*a)*m10*s1*s2*1.6E1+(a*a*a)*m10*s1*s3*1.6E1-(a*a)*m01*s1*s2*pow(a*a*a,1.0/3.0)*1.6E1-(a*a)*m01*s1*s3*pow(a*a*a,1.0/3.0)*1.6E1)/((a*a*a*a)*s2*pow(a*a*a,2.0/3.0)*9.0+(a*a*a*a)*s3*pow(a*a*a,2.0/3.0)*9.0);

    }
    if(enforce_definiteness) dP_dF.Enforce_Definiteness();
}
//#####################################################################
// Function P_From_Strain_Rate
//#####################################################################
template<class T,int d> MATRIX<T,d> MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
P_From_Strain_Rate(const DIAGONAL_MATRIX<T,d>& F,const MATRIX<T,d>& F_dot,const T scale,const int simplex) const
{
    SYMMETRIC_MATRIX<T,d> strain_rate=F_dot.Symmetric_Part(); // use linear damping because of problems with inverting elements...
    return 2*scale*constant_beta*strain_rate+scale*constant_alpha*strain_rate.Trace();
}
//#####################################################################
// Function P_From_Strain_Rate_Forces_Size
//#####################################################################
template<class T,int d> int MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
P_From_Strain_Rate_Forces_Size() const
{
    return sizeof(MATRIX<T,d>)/sizeof(T);
}
//#####################################################################
// Function P_From_Strain_Rate_First_Half
//#####################################################################
template<class T,int d> void MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
P_From_Strain_Rate_First_Half(const DIAGONAL_MATRIX<T,d>& F,ARRAY_VIEW<T> aggregate,const MATRIX<T,d>& F_dot,const T scale,const int simplex) const
{
    SYMMETRIC_MATRIX<T,d> strain_rate=scale*F_dot.Symmetric_Part(); // use linear damping because of problems with inverting elements...
    T sb=sqrt(2*constant_beta);
    T dd=sb/TV::dimension;
    T sa=sqrt(constant_alpha/TV::dimension+dd*dd)-dd;
    SYMMETRIC_MATRIX<T,d> s=sb*strain_rate+sa*strain_rate.Trace();
    *(MATRIX<T,d>*)aggregate.Get_Array_Pointer()+=s;
}
//#####################################################################
// Function P_From_Strain_Rate_Second_Half
//#####################################################################
template<class T,int d> MATRIX<T,d> MOONEY_RIVLIN_3D_EXTRAPOLATED<T,d>::
P_From_Strain_Rate_Second_Half(const DIAGONAL_MATRIX<T,d>& F,ARRAY_VIEW<const T> aggregate,const T scale,const int simplex) const
{
    SYMMETRIC_MATRIX<T,d> strain_rate=scale*(*(const MATRIX<T,d>*)aggregate.Get_Array_Pointer()).Symmetric_Part(); // use linear damping because of problems with inverting elements...
    T sb=sqrt(2*constant_beta);
    T dd=sb/TV::dimension;
    T sa=sqrt(constant_alpha/TV::dimension+dd*dd)-dd;
    return sb*strain_rate+sa*strain_rate.Trace();
}
template class MOONEY_RIVLIN_3D_EXTRAPOLATED<float,2>;
template class MOONEY_RIVLIN_3D_EXTRAPOLATED<float,3>;
#ifndef COMPILE_WITHOUT_DOUBLE_SUPPORT
template class MOONEY_RIVLIN_3D_EXTRAPOLATED<double,2>;
template class MOONEY_RIVLIN_3D_EXTRAPOLATED<double,3>;
#endif
